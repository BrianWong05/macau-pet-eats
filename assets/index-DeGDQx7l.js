import{u as k,j as t,s as g}from"./index-CmKh2cFY.js";import{r as a}from"./react-vendor-B-2HpIm1.js";import{M as w,c as y,B as S,a3 as P,Q as C,q as _,t as p}from"./ui-vendor-CRea9Wwv.js";import{P as E}from"./index-j3PFD1q2.js";import"./supabase-K6a4hp2a.js";const F={bug:S,feature:y,general:w},I={bug:"text-red-500 bg-red-50",feature:"text-amber-500 bg-amber-50",general:"text-blue-500 bg-blue-50"},O={pending:"bg-amber-100 text-amber-700",reviewed:"bg-blue-100 text-blue-700",resolved:"bg-green-100 text-green-700"},L=[10,25,50,100];function z(){const{t:s}=k(),[l,b]=a.useState([]),[h,u]=a.useState(!0),[c,f]=a.useState("all"),[d,x]=a.useState(1),[r,j]=a.useState(25),m=async()=>{u(!0);let e=g.from("app_feedback").select("*").order("created_at",{ascending:!1});c!=="all"&&(e=e.eq("status",c));const{data:n,error:o}=await e;!o&&n&&b(n),u(!1)};a.useEffect(()=>{m()},[c]),a.useEffect(()=>{x(1)},[c,r]);const v=Math.ceil(l.length/r),N=a.useMemo(()=>{const e=(d-1)*r;return l.slice(e,e+r)},[l,d,r]),i=async(e,n)=>{const{error:o}=await g.from("app_feedback").update({status:n,updated_at:new Date().toISOString()}).eq("id",e);o?p.error("Failed to update status"):(p.success(s("admin.feedback.statusUpdated")||"Status updated"),m())};return t.jsxs("div",{children:[t.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-neutral-900",children:s("admin.feedback.title")||"User Feedback"}),t.jsx("p",{className:"text-neutral-500 mt-1",children:s("admin.feedback.subtitle")||"View and manage user feedback"})]})}),t.jsx("div",{className:"flex gap-2 mb-6",children:["all","pending","reviewed","resolved"].map(e=>t.jsx("button",{onClick:()=>f(e),className:`px-4 py-2 rounded-lg font-medium text-sm transition-colors ${c===e?"bg-primary-500 text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}`,children:s(`admin.feedback.status.${e}`)||e},e))}),t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("p",{className:"text-sm text-neutral-500",children:s("search.results",{count:l.length})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("label",{htmlFor:"feedback-page-size",className:"text-sm text-neutral-500",children:[s("search.perPage"),":"]}),t.jsx("select",{id:"feedback-page-size",value:r,onChange:e=>j(Number(e.target.value)),className:"px-3 py-1.5 text-sm border border-neutral-200 rounded-lg bg-white focus:ring-2 focus:ring-primary-500",children:L.map(e=>t.jsx("option",{value:e,children:e},e))})]})]}),t.jsx("div",{className:"space-y-4",children:h?t.jsx("div",{className:"text-center py-12 text-neutral-500",children:"Loading..."}):l.length===0?t.jsx("div",{className:"text-center py-12 text-neutral-500",children:s("admin.feedback.empty")||"No feedback yet"}):N.map(e=>{const n=F[e.type];return t.jsx("div",{className:"bg-white rounded-xl border border-neutral-200 p-5",children:t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[t.jsx("div",{className:`p-2 rounded-lg ${I[e.type]}`,children:t.jsx(n,{size:18})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${O[e.status]}`,children:s(`admin.feedback.status.${e.status}`)||e.status}),t.jsx("span",{className:"text-xs text-neutral-400",children:new Date(e.created_at).toLocaleString()})]}),t.jsx("p",{className:"text-neutral-900 whitespace-pre-wrap",children:e.message}),e.contact_email&&t.jsxs("p",{className:"text-sm text-neutral-500 mt-2",children:["ðŸ“§ ",e.contact_email]}),e.page_url&&t.jsxs("p",{className:"text-xs text-neutral-400 mt-1 truncate",children:["ðŸ“ ",e.page_url]})]})]}),t.jsxs("div",{className:"flex gap-1",children:[e.status!=="reviewed"&&t.jsx("button",{onClick:()=>i(e.id,"reviewed"),className:"p-2 text-blue-500 hover:bg-blue-50 rounded-lg transition-colors",title:"Mark as Reviewed",children:t.jsx(P,{size:18})}),e.status!=="resolved"&&t.jsx("button",{onClick:()=>i(e.id,"resolved"),className:"p-2 text-green-500 hover:bg-green-50 rounded-lg transition-colors",title:"Mark as Resolved",children:t.jsx(C,{size:18})}),e.status!=="pending"&&t.jsx("button",{onClick:()=>i(e.id,"pending"),className:"p-2 text-amber-500 hover:bg-amber-50 rounded-lg transition-colors",title:"Mark as Pending",children:t.jsx(_,{size:18})})]})]})},e.id)})}),t.jsx(E,{currentPage:d,totalPages:v,onPageChange:x})]})}export{z as AdminFeedback};
