import{u as v,j as e,b as $}from"./index-DfEU2ak3.js";import{L as z,r as c,h as R}from"./react-vendor-7d_4YsRm.js";import{L as T,u as E}from"./useRestaurants-CCpoe5D0.js";import{L as A}from"./index-BJHCBUht.js";import{A as F,i as I,X as P,m as L,P as M}from"./ui-vendor-f2-SRabJ.js";import{R as O}from"./index-tEjH9dHe.js";import{S as Q}from"./index-Di_xJv07.js";import{P as D}from"./index-CGdVyfMU.js";import"./supabase-K6a4hp2a.js";import"./index-BmGE11R0.js";import"./useFavorites-Dl6bqNeQ.js";function q({searchQuery:n,setSearchQuery:r,handleClearSearch:o,showFilters:i,setShowFilters:d,hasActiveFilters:u}){const{t:a}=v(["search","restaurant","common"]);return e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(z,{to:"/",className:"p-2 hover:bg-neutral-100 rounded-xl transition-colors shrink-0","aria-label":a("restaurant:backToList"),children:e.jsx(F,{size:20,className:"text-neutral-600"})}),e.jsxs("div",{className:"relative flex-1 max-w-2xl",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(I,{className:"h-5 w-5 text-neutral-400"})}),e.jsx("input",{type:"text",value:n,onChange:m=>r(m.target.value),placeholder:a("search:placeholder"),autoFocus:!0,className:`
              w-full pl-12 pr-12 py-3
              text-base
              bg-neutral-50
              border border-neutral-200
              rounded-xl
              placeholder:text-neutral-400
              focus:outline-none focus:border-primary-400 focus:ring-2 focus:ring-primary-100 focus:bg-white
              transition-all duration-200
            `}),n&&e.jsx("button",{onClick:o,className:"absolute inset-y-0 right-0 pr-4 flex items-center text-neutral-400 hover:text-neutral-600 transition-colors","aria-label":a("common:close"),children:e.jsx(P,{className:"h-5 w-5"})})]}),e.jsxs("button",{onClick:()=>d(!i),className:`
            inline-flex items-center gap-2 px-4 py-3
            rounded-xl border text-sm font-medium
            transition-all shrink-0
            ${u?"bg-primary-50 border-primary-200 text-primary-700":"bg-white border-neutral-200 text-neutral-700 hover:bg-neutral-50"}
          `,children:[e.jsx(L,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:a("search:filter")}),u&&e.jsx("span",{className:"w-2 h-2 bg-primary-500 rounded-full"})]}),e.jsx(A,{})]})})}function G({petPolicyFilter:n,setPetPolicyFilter:r,cuisineFilters:o,toggleCuisineFilter:i,locationFilter:d,setLocationFilter:u,cuisineTypes:a,clearFilters:m,hasActiveFilters:h}){const{t:s,i18n:b}=v(["explore","common","search"]),x=b.language,{petPolicies:p,getPetPolicyDisplayName:g}=$(),l=t=>({澳門:{zh:"澳門",en:"Macau",pt:"Macau"},氹仔:{zh:"氹仔",en:"Taipa",pt:"Taipa"},路環:{zh:"路環",en:"Coloane",pt:"Coloane"}})[t][x]||t,f=p.length>0?p.map(t=>t.name):["indoors_allowed","patio_only","small_pets_only","all_pets_welcome","dogs_only","cats_only","medium_dogs_allowed"];return e.jsx("div",{className:"border-t border-neutral-100 bg-white px-4 py-4 animate-fade-in",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-4",children:[u&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700 mb-2 block",children:s("explore:filters.location")||"地區"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>u(null),className:`
                  px-3 py-1.5 rounded-full text-sm font-medium transition-all
                  ${d?"bg-neutral-100 text-neutral-600 hover:bg-neutral-200":"bg-amber-500 text-white shadow-sm"}
                `,children:s("explore:filters.all")}),T.map(t=>e.jsx("button",{onClick:()=>u(t),className:`
                    px-3 py-1.5 rounded-full text-sm font-medium transition-all
                    ${d===t?"bg-amber-500 text-white shadow-sm":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                  `,children:l(t)},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700 mb-2 block",children:s("explore:filters.petPolicy")}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>r(null),className:`
                px-3 py-1.5 rounded-full text-sm font-medium transition-all
                ${n?"bg-neutral-100 text-neutral-600 hover:bg-neutral-200":"bg-primary-500 text-white shadow-sm"}
              `,children:s("explore.filters.all")}),f.map(t=>e.jsx("button",{onClick:()=>r(t),className:`
                  px-3 py-1.5 rounded-full text-sm font-medium transition-all
                  ${n===t?"bg-primary-500 text-white shadow-sm":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                `,children:g(t,x)},t))]})]}),a.length>0&&e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-neutral-700 mb-2 block",children:[s("explore:filters.cuisine")," ",o.length>0&&`(${o.length})`]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>{o.forEach(t=>i(t))},className:`
                  px-3 py-1.5 rounded-full text-sm font-medium transition-all
                  ${o.length===0?"bg-secondary-500 text-white shadow-sm":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                `,children:s("explore:filters.all")}),a.map(t=>{const N=o.includes(t.name);return e.jsx("button",{onClick:()=>i(t.name),className:`
                      px-3 py-1.5 rounded-full text-sm font-medium transition-all
                      ${N?"bg-secondary-500 text-white shadow-sm":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                    `,children:x==="zh"?t.name_zh||t.name:x==="pt"&&t.name_pt||t.name},t.id)}),e.jsx("button",{onClick:()=>i("__other__"),className:`
                  px-3 py-1.5 rounded-full text-sm font-medium transition-all
                  ${o.includes("__other__")?"bg-secondary-500 text-white shadow-sm":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                `,children:s("common:other")||"其他"})]})]}),h&&e.jsxs("button",{onClick:m,className:"inline-flex items-center gap-1.5 text-sm text-neutral-500 hover:text-neutral-700",children:[e.jsx(P,{size:14}),s("search:clearFilters")]})]})})}const H=[6,12,24,48];function X({restaurants:n,isLoading:r,searchQuery:o,handleClearSearch:i,clearFilters:d,hasActiveFilters:u}){const{t:a}=v(["search","common"]),[m,h]=c.useState(1),[s,b]=c.useState(12);c.useMemo(()=>{h(1)},[n.length,o,s]);const x=Math.ceil(n.length/s),p=c.useMemo(()=>{const l=(m-1)*s;return n.slice(l,l+s)},[n,m,s]),g=l=>{h(l),window.scrollTo({top:0,behavior:"smooth"})};return e.jsxs("main",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-neutral-900",children:a("search:title")}),!r&&e.jsx("p",{className:"text-neutral-500 mt-1",children:a("search:results",{count:n.length})})]}),!r&&n.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{htmlFor:"page-size",className:"text-sm text-neutral-500",children:[a("search:perPage")||"Per page",":"]}),e.jsx("select",{id:"page-size",value:s,onChange:l=>b(Number(l.target.value)),className:"px-3 py-1.5 text-sm border border-neutral-200 rounded-lg bg-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:H.map(l=>e.jsx("option",{value:l,children:l},l))})]})]}),r&&e.jsx(Q,{count:6}),!r&&n.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map((l,f)=>e.jsx("div",{className:"animate-fade-in",style:{animationDelay:`${f*50}ms`},children:e.jsx(O,{restaurant:l})},l.id))}),e.jsx(D,{currentPage:m,totalPages:x,onPageChange:g})]}),!r&&n.length===0&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-neutral-100 rounded-full mb-6",children:e.jsx(M,{className:"w-10 h-10 text-neutral-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-700 mb-2",children:a("search:noResults")}),e.jsx("p",{className:"text-neutral-500 mb-6 max-w-md mx-auto",children:a("search:noResultsHint")}),(o||u)&&e.jsxs("button",{onClick:()=>{i(),d()},className:"inline-flex items-center gap-2 px-6 py-3 bg-primary-500 text-white font-medium rounded-xl hover:bg-primary-600 transition-colors",children:[e.jsx(P,{size:18}),a("search:clearFilters")]})]})]})}function ae(){const[n,r]=R(),o=n.get("q")||"",[i,d]=c.useState(o),[u,a]=c.useState(o),[m,h]=c.useState(null),[s,b]=c.useState([]),[x,p]=c.useState(null),[g,l]=c.useState(!1),{restaurants:f,cuisineTypes:t,isLoading:N}=E({searchQuery:u,petPolicyFilter:m,cuisineFilters:s,locationFilter:x});c.useEffect(()=>{const j=setTimeout(()=>{a(i),r(i?{q:i}:{})},300);return()=>clearTimeout(j)},[i,r]);const C=c.useCallback(()=>{d(""),a(""),r({})},[r]),S=c.useCallback(()=>{h(null),b([]),p(null)},[]),k=c.useCallback(j=>{b(w=>w.includes(j)?w.filter(_=>_!==j):[...w,j])},[]),y=m||s.length>0||x;return e.jsxs("div",{className:"min-h-screen bg-neutral-50",children:[e.jsxs("header",{className:"sticky top-0 bg-white border-b border-neutral-200 z-20",children:[e.jsx(q,{searchQuery:i,setSearchQuery:d,handleClearSearch:C,showFilters:g,setShowFilters:l,hasActiveFilters:y}),g&&e.jsx(G,{petPolicyFilter:m,setPetPolicyFilter:h,cuisineFilters:s,toggleCuisineFilter:k,locationFilter:x,setLocationFilter:p,cuisineTypes:t,clearFilters:S,hasActiveFilters:y})]}),e.jsx(X,{restaurants:f,isLoading:N,searchQuery:i,handleClearSearch:C,clearFilters:S,hasActiveFilters:y})]})}export{ae as Search};
