import{u as v,j as e,b as z}from"./index-CCFjVqBI.js";import{L as R,r as o,h as T}from"./react-vendor-7d_4YsRm.js";import{A as M}from"./index-DSpSv0ha.js";import{L as E,u as O}from"./useRestaurants-C1xiEk-Y.js";import{L as I}from"./index-LclTNxZ1.js";import{A as F,j as L,X as P,n as Q,P as q}from"./ui-vendor-uHOkKSV_.js";import{R as D}from"./index-D-pka622.js";import{S as G}from"./index-BwVUFmaU.js";import{P as H}from"./index-PgiJaCzx.js";import"./supabase-K6a4hp2a.js";import"./index-DbodRVV6.js";import"./useFavorites-DuJztAlP.js";function X({searchQuery:a,setSearchQuery:l,handleClearSearch:i,showFilters:d,setShowFilters:h,hasActiveFilters:n}){const{t:c}=v(["search","restaurant","common"]);return e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(R,{to:"/",className:"p-2 hover:bg-neutral-100 rounded-xl transition-colors shrink-0","aria-label":c("restaurant:backToList"),children:e.jsx(F,{size:20,className:"text-neutral-600"})}),e.jsxs("div",{className:"relative flex-1 max-w-2xl",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(L,{className:"h-5 w-5 text-neutral-400"})}),e.jsx("input",{type:"text",value:a,onChange:m=>l(m.target.value),placeholder:c("search:placeholder"),autoFocus:!0,className:`
              w-full pl-12 pr-12 py-3
              text-base
              bg-neutral-50
              border border-neutral-200
              rounded-xl
              placeholder:text-neutral-400
              focus:outline-none focus:border-primary-400 focus:ring-2 focus:ring-primary-100 focus:bg-white
              transition-all duration-200
            `}),a&&e.jsx("button",{onClick:i,className:"absolute inset-y-0 right-0 pr-4 flex items-center text-neutral-400 hover:text-neutral-600 transition-colors","aria-label":c("common:close"),children:e.jsx(P,{className:"h-5 w-5"})})]}),e.jsxs("button",{onClick:()=>h(!d),className:`
            inline-flex items-center gap-2 px-4 py-3
            rounded-xl border text-sm font-medium
            transition-all shrink-0
            ${n?"bg-primary-50 border-primary-200 text-primary-700":"bg-white border-neutral-200 text-neutral-700 hover:bg-neutral-50"}
          `,children:[e.jsx(Q,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:c("search:filter")}),n&&e.jsx("span",{className:"w-2 h-2 bg-primary-500 rounded-full"})]}),e.jsx(I,{})]})})}function Z({petPolicyFilter:a,setPetPolicyFilter:l,cuisineFilters:i,toggleCuisineFilter:d,locationFilter:h,setLocationFilter:n,cuisineTypes:c,clearFilters:m,hasActiveFilters:p}){const{t:r,i18n:u}=v(["explore","common","search"]),x=u.language,{petPolicies:b,getPetPolicyDisplayName:g}=z(),f=t=>({澳門:{zh:"澳門",en:"Macau",pt:"Macau"},氹仔:{zh:"氹仔",en:"Taipa",pt:"Taipa"},路環:{zh:"路環",en:"Coloane",pt:"Coloane"}})[t][x]||t,s=b.length>0?b.map(t=>t.name):["indoors_allowed","patio_only","small_pets_only","all_pets_welcome","dogs_only","cats_only","medium_dogs_allowed"];return e.jsx("div",{className:"border-t border-neutral-100 bg-white px-4 py-4 animate-fade-in",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-4",children:[n&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700 mb-2 block",children:r("explore:filters.location")||"地區"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>n(null),className:`
                  px-3 py-1.5 rounded-full text-sm font-medium transition-all
                  ${h?"bg-neutral-100 text-neutral-600 hover:bg-neutral-200":"bg-amber-500 text-white shadow-sm"}
                `,children:r("explore:filters.all")}),E.map(t=>e.jsx("button",{onClick:()=>n(t),className:`
                    px-3 py-1.5 rounded-full text-sm font-medium transition-all
                    ${h===t?"bg-amber-500 text-white shadow-sm":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                  `,children:f(t)},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700 mb-2 block",children:r("explore:filters.petPolicy")}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>l(null),className:`
                px-3 py-1.5 rounded-full text-sm font-medium transition-all
                ${a?"bg-neutral-100 text-neutral-600 hover:bg-neutral-200":"bg-primary-500 text-white shadow-sm"}
              `,children:r("explore.filters.all")}),s.map(t=>e.jsx("button",{onClick:()=>l(t),className:`
                  px-3 py-1.5 rounded-full text-sm font-medium transition-all
                  ${a===t?"bg-primary-500 text-white shadow-sm":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                `,children:g(t,x)},t))]})]}),c.length>0&&e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-neutral-700 mb-2 block",children:[r("explore:filters.cuisine")," ",i.length>0&&`(${i.length})`]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>{i.forEach(t=>d(t))},className:`
                  px-3 py-1.5 rounded-full text-sm font-medium transition-all
                  ${i.length===0?"bg-secondary-500 text-white shadow-sm":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                `,children:r("explore:filters.all")}),c.map(t=>{const N=i.includes(t.name);return e.jsx("button",{onClick:()=>d(t.name),className:`
                      px-3 py-1.5 rounded-full text-sm font-medium transition-all
                      ${N?"bg-secondary-500 text-white shadow-sm":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                    `,children:x==="zh"?t.name_zh||t.name:x==="pt"&&t.name_pt||t.name},t.id)}),e.jsx("button",{onClick:()=>d("__other__"),className:`
                  px-3 py-1.5 rounded-full text-sm font-medium transition-all
                  ${i.includes("__other__")?"bg-secondary-500 text-white shadow-sm":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                `,children:r("common:other")||"其他"})]})]}),p&&e.jsxs("button",{onClick:m,className:"inline-flex items-center gap-1.5 text-sm text-neutral-500 hover:text-neutral-700",children:[e.jsx(P,{size:14}),r("search:clearFilters")]})]})})}const B=[6,12,24,48];function J({restaurants:a,isLoading:l,searchQuery:i,handleClearSearch:d,clearFilters:h,hasActiveFilters:n,onAuthRequired:c}){const{t:m}=v(["search","common"]),[p,r]=o.useState(1),[u,x]=o.useState(12);o.useMemo(()=>{r(1)},[a.length,i,u]);const b=Math.ceil(a.length/u),g=o.useMemo(()=>{const s=(p-1)*u;return a.slice(s,s+u)},[a,p,u]),f=s=>{r(s),window.scrollTo({top:0,behavior:"smooth"})};return e.jsxs("main",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-neutral-900",children:m("search:title")}),!l&&e.jsx("p",{className:"text-neutral-500 mt-1",children:m("search:results",{count:a.length})})]}),!l&&a.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{htmlFor:"page-size",className:"text-sm text-neutral-500",children:[m("search:perPage")||"Per page",":"]}),e.jsx("select",{id:"page-size",value:u,onChange:s=>x(Number(s.target.value)),className:"px-3 py-1.5 text-sm border border-neutral-200 rounded-lg bg-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:B.map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),l&&e.jsx(G,{count:6}),!l&&a.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map((s,t)=>e.jsx("div",{className:"animate-fade-in",style:{animationDelay:`${t*50}ms`},children:e.jsx(D,{restaurant:s,onAuthRequired:c})},s.id))}),e.jsx(H,{currentPage:p,totalPages:b,onPageChange:f})]}),!l&&a.length===0&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-neutral-100 rounded-full mb-6",children:e.jsx(q,{className:"w-10 h-10 text-neutral-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-700 mb-2",children:m("search:noResults")}),e.jsx("p",{className:"text-neutral-500 mb-6 max-w-md mx-auto",children:m("search:noResultsHint")}),(i||n)&&e.jsxs("button",{onClick:()=>{d(),h()},className:"inline-flex items-center gap-2 px-6 py-3 bg-primary-500 text-white font-medium rounded-xl hover:bg-primary-600 transition-colors",children:[e.jsx(P,{size:18}),m("search:clearFilters")]})]})]})}function oe(){const[a,l]=T(),i=a.get("q")||"",[d,h]=o.useState(!1),[n,c]=o.useState(i),[m,p]=o.useState(i),[r,u]=o.useState(null),[x,b]=o.useState([]),[g,f]=o.useState(null),[s,t]=o.useState(!1),{restaurants:N,cuisineTypes:k,isLoading:_}=O({searchQuery:m,petPolicyFilter:r,cuisineFilters:x,locationFilter:g});o.useEffect(()=>{const j=setTimeout(()=>{p(n),l(n?{q:n}:{})},300);return()=>clearTimeout(j)},[n,l]);const C=o.useCallback(()=>{c(""),p(""),l({})},[l]),S=o.useCallback(()=>{u(null),b([]),f(null)},[]),A=o.useCallback(j=>{b(w=>w.includes(j)?w.filter($=>$!==j):[...w,j])},[]),y=r||x.length>0||g;return e.jsxs("div",{className:"min-h-screen bg-neutral-50",children:[e.jsxs("header",{className:"sticky top-0 bg-white border-b border-neutral-200 z-20",children:[e.jsx(X,{searchQuery:n,setSearchQuery:c,handleClearSearch:C,showFilters:s,setShowFilters:t,hasActiveFilters:y}),s&&e.jsx(Z,{petPolicyFilter:r,setPetPolicyFilter:u,cuisineFilters:x,toggleCuisineFilter:A,locationFilter:g,setLocationFilter:f,cuisineTypes:k,clearFilters:S,hasActiveFilters:y})]}),e.jsx(J,{restaurants:N,isLoading:_,searchQuery:n,handleClearSearch:C,clearFilters:S,hasActiveFilters:y,onAuthRequired:()=>h(!0)}),e.jsx(M,{isOpen:d,onClose:()=>h(!1)})]})}export{oe as Search};
