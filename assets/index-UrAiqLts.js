import{u as R,j as e,c as $,b as Q,s as y}from"./index-CmKh2cFY.js";import{h as B,r as i}from"./react-vendor-B-2HpIm1.js";import{i as Z,Q as L,Y as q,Z as G,w as U,q as D,_ as X,t as C}from"./ui-vendor-CRea9Wwv.js";import{R as Y}from"./index-D5tAYuyW.js";import{P as H}from"./index-j3PFD1q2.js";import"./supabase-K6a4hp2a.js";function J({searchQuery:r,setSearchQuery:g,filterStatus:o,setFilterStatus:f}){const{t:x}=R(),a=["all","pending","approved"];return e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:x("admin.restaurants.searchPlaceholder"),value:r,onChange:n=>g(n.target.value),className:"w-full pl-10 pr-4 py-2 bg-white border border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsx("div",{className:"flex gap-2",children:a.map(n=>e.jsx("button",{onClick:()=>f(n),className:`px-4 py-2 rounded-xl text-sm font-medium transition-colors ${o===n?"bg-neutral-900 text-white":"bg-white border border-neutral-200 text-neutral-600 hover:bg-neutral-50"}`,children:x(`admin.restaurants.filters.${n}`)},n))})]})}function K({restaurants:r,isLoading:g,onStatusUpdate:o,onEdit:f,onDelete:x}){const{t:a,i18n:n}=R(),{getLocalizedName:m}=$(),{getPetPolicyDisplayName:N}=Q(),c=n.language,v=({status:t})=>{const l={approved:"bg-green-100 text-green-700",pending:"bg-amber-100 text-amber-700",rejected:"bg-red-100 text-red-700"},p={approved:L,pending:D,rejected:q}[t]||D;return e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium ${l[t]||l.pending}`,children:[e.jsx(p,{size:12}),t==="pending"?a("admin.restaurants.status.pending"):t==="approved"?a("admin.restaurants.status.approved"):t==="rejected"?a("admin.restaurants.status.rejected"):t]})};return e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-neutral-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-neutral-500 uppercase tracking-wider",children:a("admin.restaurants.table.headers.restaurant")}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-neutral-500 uppercase tracking-wider",children:a("admin.restaurants.table.headers.status")}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-neutral-500 uppercase tracking-wider",children:a("admin.restaurants.table.headers.petPolicy")}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-neutral-500 uppercase tracking-wider",children:a("admin.restaurants.table.headers.submitted")}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-neutral-500 uppercase tracking-wider",children:a("admin.restaurants.table.headers.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-neutral-200",children:g?[1,2,3].map(t=>e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4",children:e.jsx("div",{className:"h-4 bg-neutral-100 rounded w-3/4 animate-pulse"})})},t)):r.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-neutral-500",children:a("admin.restaurants.table.noRestaurants")})}):r.map(t=>e.jsxs("tr",{className:"hover:bg-neutral-50/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:t.image_url||"https://via.placeholder.com/40",alt:"",className:"w-10 h-10 rounded-lg object-cover bg-neutral-100"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-neutral-900",children:t.name_zh||t.name}),e.jsx("p",{className:"text-sm text-neutral-500",children:Array.isArray(t.cuisine_type)?t.cuisine_type.map(l=>m(l,c)).join(", "):t.cuisine_type})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(v,{status:t.status||"approved"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-neutral-600",children:N(t.pet_policy,c)}),e.jsx("td",{className:"px-6 py-4 text-sm text-neutral-600",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>o(t.id,"approved"),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Approve",children:e.jsx(L,{size:18})}),e.jsx("button",{onClick:()=>o(t.id,"rejected"),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Reject",children:e.jsx(q,{size:18})}),e.jsx("div",{className:"w-px h-4 bg-neutral-200 mx-1"})]}),e.jsx("button",{className:"p-2 text-neutral-400 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",onClick:()=>f(t),children:e.jsx(G,{size:18})}),e.jsx("button",{className:"p-2 text-neutral-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",onClick:()=>x(t.id),children:e.jsx(U,{size:18})})]})})]},t.id))})]})})})}const V=[10,25,50,100];function ne(){const{t:r}=R(),[g,o]=B(),[f,x]=i.useState([]),[a,n]=i.useState(!0),[m,N]=i.useState(""),[c,v]=i.useState("all"),[t,l]=i.useState(!1),[k,p]=i.useState(null),[w,_]=i.useState(1),[h,A]=i.useState(25),j=async()=>{n(!0);let s=y.from("restaurants").select("*").order("created_at",{ascending:!1});c!=="all"&&(s=s.eq("status",c));const{data:d,error:S}=await s;if(!S&&d){const z=d;x(z);const P=g.get("edit");if(P){const E=z.find(u=>u.id===P);if(E)p(E),l(!0),o(u=>(u.delete("edit"),u));else{const{data:u}=await y.from("restaurants").select("*").eq("id",P).single();u&&(p(u),l(!0),o(I=>(I.delete("edit"),I)))}}}n(!1)};i.useEffect(()=>{j()},[c]),i.useEffect(()=>{_(1)},[m,c,h]);const F=async s=>{if(!confirm("Are you sure you want to delete this restaurant?"))return;const{error:d}=await y.from("restaurants").delete().eq("id",s);d||(C.success("Restaurant deleted successfully"),j())},M=async(s,d)=>{const{error:S}=await y.from("restaurants").update({status:d}).eq("id",s);S||(C.success(`Restaurant ${d} successfully`),C.success(r(d==="approved"?"admin.restaurants.actions.approveSuccess":"admin.restaurants.actions.rejectSuccess")),j())},b=f.filter(s=>s.name.toLowerCase().includes(m.toLowerCase())||s.name_zh?.toLowerCase().includes(m.toLowerCase())),O=Math.ceil(b.length/h),T=i.useMemo(()=>{const s=(w-1)*h;return b.slice(s,s+h)},[b,w,h]);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-neutral-900",children:r("admin.restaurants.title")}),e.jsx("p",{className:"text-neutral-500 mt-1",children:r("admin.restaurants.subtitle")})]}),e.jsxs("button",{className:"inline-flex items-center gap-2 px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white font-medium rounded-xl transition-colors",onClick:()=>{p(null),l(!0)},children:[e.jsx(X,{size:20}),r("admin.restaurants.addRestaurant")]})]}),e.jsx(J,{searchQuery:m,setSearchQuery:N,filterStatus:c,setFilterStatus:v}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("p",{className:"text-sm text-neutral-500",children:r("search.results",{count:b.length})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{htmlFor:"admin-page-size",className:"text-sm text-neutral-500",children:[r("search.perPage"),":"]}),e.jsx("select",{id:"admin-page-size",value:h,onChange:s=>A(Number(s.target.value)),className:"px-3 py-1.5 text-sm border border-neutral-200 rounded-lg bg-white focus:ring-2 focus:ring-primary-500",children:V.map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),e.jsx(K,{restaurants:T,isLoading:a,onStatusUpdate:M,onEdit:s=>{p(s),l(!0)},onDelete:F}),e.jsx(H,{currentPage:w,totalPages:O,onPageChange:_}),e.jsx(Y,{isOpen:t,onClose:()=>l(!1),onSave:()=>{j(),l(!1)},restaurant:k})]})}export{ne as AdminRestaurants};
