import{u as h,j as e}from"./index-CH_RZSJt.js";import{L as k,h as S,r as m}from"./react-vendor-B-2HpIm1.js";import{u as C}from"./useRestaurants-CV5o4dXC.js";import{L as P}from"./index-CTcyadlt.js";import{A as _,d as F,X as p,h as $,P as z}from"./ui-vendor-r0va27WY.js";import{S as R,R as T}from"./index-nlh_H6z6.js";import"./supabase-K6a4hp2a.js";import"./index-BYznTCpO.js";function L({searchQuery:n,setSearchQuery:s,handleClearSearch:i,showFilters:r,setShowFilters:o,hasActiveFilters:c}){const{t:a}=h();return e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(k,{to:"/",className:"p-2 hover:bg-neutral-100 rounded-xl transition-colors shrink-0","aria-label":a("restaurant.backToList"),children:e.jsx(_,{size:20,className:"text-neutral-600"})}),e.jsxs("div",{className:"relative flex-1 max-w-2xl",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(F,{className:"h-5 w-5 text-neutral-400"})}),e.jsx("input",{type:"text",value:n,onChange:l=>s(l.target.value),placeholder:a("search.placeholder"),autoFocus:!0,className:`
              w-full pl-12 pr-12 py-3
              text-base
              bg-neutral-50
              border border-neutral-200
              rounded-xl
              placeholder:text-neutral-400
              focus:outline-none focus:border-primary-400 focus:ring-2 focus:ring-primary-100 focus:bg-white
              transition-all duration-200
            `}),n&&e.jsx("button",{onClick:i,className:"absolute inset-y-0 right-0 pr-4 flex items-center text-neutral-400 hover:text-neutral-600 transition-colors","aria-label":a("common.close"),children:e.jsx(p,{className:"h-5 w-5"})})]}),e.jsxs("button",{onClick:()=>o(!r),className:`
            inline-flex items-center gap-2 px-4 py-3
            rounded-xl border text-sm font-medium
            transition-all shrink-0
            ${c?"bg-primary-50 border-primary-200 text-primary-700":"bg-white border-neutral-200 text-neutral-700 hover:bg-neutral-50"}
          `,children:[e.jsx($,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:a("search.filter")}),c&&e.jsx("span",{className:"w-2 h-2 bg-primary-500 rounded-full"})]}),e.jsx(P,{})]})})}const Q=["indoors_allowed","patio_only","small_pets_only","all_pets_welcome","dogs_only","cats_only"];function E({petPolicyFilter:n,setPetPolicyFilter:s,cuisineFilter:i,setCuisineFilter:r,cuisineTypes:o,clearFilters:c,hasActiveFilters:a}){const{t:l,i18n:u}=h(),x=u.language;return e.jsx("div",{className:"border-t border-neutral-100 bg-white px-4 py-4 animate-fade-in",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700 mb-2 block",children:l("explore.filters.petPolicy")}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>s(null),className:`
                px-3 py-1.5 rounded-full text-sm font-medium transition-all
                ${n?"bg-neutral-100 text-neutral-600 hover:bg-neutral-200":"bg-primary-500 text-white shadow-sm"}
              `,children:l("explore.filters.all")}),Q.map(t=>e.jsx("button",{onClick:()=>s(t),className:`
                  px-3 py-1.5 rounded-full text-sm font-medium transition-all
                  ${n===t?"bg-primary-500 text-white shadow-sm":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                `,children:l(`petPolicy.${t}`)},t))]})]}),o.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700 mb-2 block",children:l("explore.filters.cuisine")}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>r(null),className:`
                  px-3 py-1.5 rounded-full text-sm font-medium transition-all
                  ${i?"bg-neutral-100 text-neutral-600 hover:bg-neutral-200":"bg-secondary-500 text-white shadow-sm"}
                `,children:l("explore.filters.all")}),o.map(t=>e.jsx("button",{onClick:()=>r(t.name),className:`
                    px-3 py-1.5 rounded-full text-sm font-medium transition-all
                    ${i===t.name?"bg-secondary-500 text-white shadow-sm":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                  `,children:x==="zh"?t.name_zh||t.name:x==="pt"&&t.name_pt||t.name},t.id))]})]}),a&&e.jsxs("button",{onClick:c,className:"inline-flex items-center gap-1.5 text-sm text-neutral-500 hover:text-neutral-700",children:[e.jsx(p,{size:14}),l("search.clearFilters")]})]})})}function O({restaurants:n,isLoading:s,searchQuery:i,handleClearSearch:r,clearFilters:o,hasActiveFilters:c}){const{t:a}=h();return e.jsxs("main",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-neutral-900",children:a("search.title")}),!s&&e.jsx("p",{className:"text-neutral-500 mt-1",children:a("search.results",{count:n.length})})]})}),s&&e.jsx(R,{count:6}),!s&&n.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map((l,u)=>e.jsx("div",{className:"animate-fade-in",style:{animationDelay:`${u*50}ms`},children:e.jsx(T,{restaurant:l})},l.id))}),!s&&n.length===0&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-neutral-100 rounded-full mb-6",children:e.jsx(z,{className:"w-10 h-10 text-neutral-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-700 mb-2",children:a("search.noResults")}),e.jsx("p",{className:"text-neutral-500 mb-6 max-w-md mx-auto",children:a("search.noResultsHint")}),(i||c)&&e.jsxs("button",{onClick:()=>{r(),o()},className:"inline-flex items-center gap-2 px-6 py-3 bg-primary-500 text-white font-medium rounded-xl hover:bg-primary-600 transition-colors",children:[e.jsx(p,{size:18}),a("search.clearFilters")]})]})]})}function B(){const[n,s]=S(),i=n.get("q")||"",[r,o]=m.useState(i),[c,a]=m.useState(i),[l,u]=m.useState(null),[x,t]=m.useState(null),[b,g]=m.useState(!1),{restaurants:y,cuisineTypes:N,isLoading:w}=C({searchQuery:c,petPolicyFilter:l,cuisineFilter:x});m.useEffect(()=>{const v=setTimeout(()=>{a(r),s(r?{q:r}:{})},300);return()=>clearTimeout(v)},[r,s]);const f=m.useCallback(()=>{o(""),a(""),s({})},[s]),j=m.useCallback(()=>{u(null),t(null)},[]),d=l||x;return e.jsxs("div",{className:"min-h-screen bg-neutral-50",children:[e.jsxs("header",{className:"sticky top-0 bg-white border-b border-neutral-200 z-20",children:[e.jsx(L,{searchQuery:r,setSearchQuery:o,handleClearSearch:f,showFilters:b,setShowFilters:g,hasActiveFilters:d}),b&&e.jsx(E,{petPolicyFilter:l,setPetPolicyFilter:u,cuisineFilter:x,setCuisineFilter:t,cuisineTypes:N,clearFilters:j,hasActiveFilters:d})]}),e.jsx(O,{restaurants:y,isLoading:w,searchQuery:r,handleClearSearch:f,clearFilters:j,hasActiveFilters:d})]})}export{B as Search};
