import{r as t}from"./react-vendor-B-2HpIm1.js";import{s as f}from"./index-CH_RZSJt.js";function C(p={}){const{searchQuery:r="",petPolicyFilter:a=null,cuisineFilter:n=null}=p,[o,d]=t.useState([]),[y,h]=t.useState([]),[g,i]=t.useState(!0),[m,l]=t.useState(null),c=t.useCallback(async()=>{i(!0),l(null);try{let e=f.from("restaurants").select("*").eq("status","approved");r.trim()&&(e=e.ilike("name",`%${r}%`)),a&&(e=e.eq("pet_policy",a)),n&&(e=e.contains("cuisine_type",[n])),console.log("useRestaurants: Fetching restaurants...");const{data:s,error:u}=await e.order("created_at",{ascending:!1});if(u)throw console.error("useRestaurants: Error",u),u;console.log("useRestaurants: Data received",s?.length),d(s||[])}catch(e){const s=e instanceof Error?e.message:"Failed to fetch restaurants";l(s),console.error("Error fetching restaurants:",e)}finally{i(!1)}},[r,a,n]);t.useEffect(()=>{(async()=>{const{data:s}=await f.from("cuisine_types").select("*").order("sort_order",{ascending:!0});s&&h(s)})()},[]),t.useEffect(()=>{c()},[c]);const E=t.useMemo(()=>o.slice(0,6),[o]);return{restaurants:o,featuredRestaurants:E,isLoading:g,error:m,refetch:c,cuisineTypes:y}}export{C as u};
