import{u as N,j as e}from"./index-da4C4Nok.js";import{L as $,h as z,r as m}from"./react-vendor-B-2HpIm1.js";import{L as T,u as R}from"./useRestaurants-Du2-ZaRd.js";import{L}from"./index-DvGUM6NA.js";import{A as E,i as A,X as y,m as O,P as Q}from"./ui-vendor-BzBFCVgS.js";import{S as F,R as I}from"./index-CF6i2AKN.js";import"./supabase-K6a4hp2a.js";import"./index-HlvzkroW.js";function q({searchQuery:i,setSearchQuery:a,handleClearSearch:n,showFilters:l,setShowFilters:u,hasActiveFilters:o}){const{t:s}=N();return e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx($,{to:"/",className:"p-2 hover:bg-neutral-100 rounded-xl transition-colors shrink-0","aria-label":s("restaurant.backToList"),children:e.jsx(E,{size:20,className:"text-neutral-600"})}),e.jsxs("div",{className:"relative flex-1 max-w-2xl",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(A,{className:"h-5 w-5 text-neutral-400"})}),e.jsx("input",{type:"text",value:i,onChange:c=>a(c.target.value),placeholder:s("search.placeholder"),autoFocus:!0,className:`
              w-full pl-12 pr-12 py-3
              text-base
              bg-neutral-50
              border border-neutral-200
              rounded-xl
              placeholder:text-neutral-400
              focus:outline-none focus:border-primary-400 focus:ring-2 focus:ring-primary-100 focus:bg-white
              transition-all duration-200
            `}),i&&e.jsx("button",{onClick:n,className:"absolute inset-y-0 right-0 pr-4 flex items-center text-neutral-400 hover:text-neutral-600 transition-colors","aria-label":s("common.close"),children:e.jsx(y,{className:"h-5 w-5"})})]}),e.jsxs("button",{onClick:()=>u(!l),className:`
            inline-flex items-center gap-2 px-4 py-3
            rounded-xl border text-sm font-medium
            transition-all shrink-0
            ${o?"bg-primary-50 border-primary-200 text-primary-700":"bg-white border-neutral-200 text-neutral-700 hover:bg-neutral-50"}
          `,children:[e.jsx(O,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:s("search.filter")}),o&&e.jsx("span",{className:"w-2 h-2 bg-primary-500 rounded-full"})]}),e.jsx(L,{})]})})}const D=["indoors_allowed","patio_only","small_pets_only","all_pets_welcome","dogs_only","cats_only"];function H({petPolicyFilter:i,setPetPolicyFilter:a,cuisineFilters:n,toggleCuisineFilter:l,locationFilter:u,setLocationFilter:o,cuisineTypes:s,clearFilters:c,hasActiveFilters:d}){const{t:r,i18n:p}=N(),x=p.language,b=t=>({澳門:{zh:"澳門",en:"Macau",pt:"Macau"},氹仔:{zh:"氹仔",en:"Taipa",pt:"Taipa"},路環:{zh:"路環",en:"Coloane",pt:"Coloane"}})[t][x]||t;return e.jsx("div",{className:"border-t border-neutral-100 bg-white px-4 py-4 animate-fade-in",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-4",children:[o&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700 mb-2 block",children:r("explore.filters.location")||"地區"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>o(null),className:`
                  px-3 py-1.5 rounded-full text-sm font-medium transition-all
                  ${u?"bg-neutral-100 text-neutral-600 hover:bg-neutral-200":"bg-amber-500 text-white shadow-sm"}
                `,children:r("explore.filters.all")}),T.map(t=>e.jsx("button",{onClick:()=>o(t),className:`
                    px-3 py-1.5 rounded-full text-sm font-medium transition-all
                    ${u===t?"bg-amber-500 text-white shadow-sm":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                  `,children:b(t)},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700 mb-2 block",children:r("explore.filters.petPolicy")}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>a(null),className:`
                px-3 py-1.5 rounded-full text-sm font-medium transition-all
                ${i?"bg-neutral-100 text-neutral-600 hover:bg-neutral-200":"bg-primary-500 text-white shadow-sm"}
              `,children:r("explore.filters.all")}),D.map(t=>e.jsx("button",{onClick:()=>a(t),className:`
                  px-3 py-1.5 rounded-full text-sm font-medium transition-all
                  ${i===t?"bg-primary-500 text-white shadow-sm":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                `,children:r(`petPolicy.${t}`)},t))]})]}),s.length>0&&e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-neutral-700 mb-2 block",children:[r("explore.filters.cuisine")," ",n.length>0&&`(${n.length})`]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>{n.forEach(t=>l(t))},className:`
                  px-3 py-1.5 rounded-full text-sm font-medium transition-all
                  ${n.length===0?"bg-secondary-500 text-white shadow-sm":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                `,children:r("explore.filters.all")}),s.map(t=>{const f=n.includes(t.name);return e.jsx("button",{onClick:()=>l(t.name),className:`
                      px-3 py-1.5 rounded-full text-sm font-medium transition-all
                      ${f?"bg-secondary-500 text-white shadow-sm":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                    `,children:x==="zh"?t.name_zh||t.name:x==="pt"&&t.name_pt||t.name},t.id)}),e.jsx("button",{onClick:()=>l("__other__"),className:`
                  px-3 py-1.5 rounded-full text-sm font-medium transition-all
                  ${n.includes("__other__")?"bg-secondary-500 text-white shadow-sm":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                `,children:r("common.other")||"其他"})]})]}),d&&e.jsxs("button",{onClick:c,className:"inline-flex items-center gap-1.5 text-sm text-neutral-500 hover:text-neutral-700",children:[e.jsx(y,{size:14}),r("search.clearFilters")]})]})})}function M({restaurants:i,isLoading:a,searchQuery:n,handleClearSearch:l,clearFilters:u,hasActiveFilters:o}){const{t:s}=N();return e.jsxs("main",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-neutral-900",children:s("search.title")}),!a&&e.jsx("p",{className:"text-neutral-500 mt-1",children:s("search.results",{count:i.length})})]})}),a&&e.jsx(F,{count:6}),!a&&i.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map((c,d)=>e.jsx("div",{className:"animate-fade-in",style:{animationDelay:`${d*50}ms`},children:e.jsx(I,{restaurant:c})},c.id))}),!a&&i.length===0&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-neutral-100 rounded-full mb-6",children:e.jsx(Q,{className:"w-10 h-10 text-neutral-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-700 mb-2",children:s("search.noResults")}),e.jsx("p",{className:"text-neutral-500 mb-6 max-w-md mx-auto",children:s("search.noResultsHint")}),(n||o)&&e.jsxs("button",{onClick:()=>{l(),u()},className:"inline-flex items-center gap-2 px-6 py-3 bg-primary-500 text-white font-medium rounded-xl hover:bg-primary-600 transition-colors",children:[e.jsx(y,{size:18}),s("search.clearFilters")]})]})]})}function W(){const[i,a]=z(),n=i.get("q")||"",[l,u]=m.useState(n),[o,s]=m.useState(n),[c,d]=m.useState(null),[r,p]=m.useState([]),[x,b]=m.useState(null),[t,f]=m.useState(!1),{restaurants:k,cuisineTypes:C,isLoading:S}=R({searchQuery:o,petPolicyFilter:c,cuisineFilters:r,locationFilter:x});m.useEffect(()=>{const h=setTimeout(()=>{s(l),a(l?{q:l}:{})},300);return()=>clearTimeout(h)},[l,a]);const w=m.useCallback(()=>{u(""),s(""),a({})},[a]),v=m.useCallback(()=>{d(null),p([]),b(null)},[]),_=m.useCallback(h=>{p(j=>j.includes(h)?j.filter(P=>P!==h):[...j,h])},[]),g=c||r.length>0||x;return e.jsxs("div",{className:"min-h-screen bg-neutral-50",children:[e.jsxs("header",{className:"sticky top-0 bg-white border-b border-neutral-200 z-20",children:[e.jsx(q,{searchQuery:l,setSearchQuery:u,handleClearSearch:w,showFilters:t,setShowFilters:f,hasActiveFilters:g}),t&&e.jsx(H,{petPolicyFilter:c,setPetPolicyFilter:d,cuisineFilters:r,toggleCuisineFilter:_,locationFilter:x,setLocationFilter:b,cuisineTypes:C,clearFilters:v,hasActiveFilters:g})]}),e.jsx(M,{restaurants:k,isLoading:S,searchQuery:l,handleClearSearch:w,clearFilters:v,hasActiveFilters:g})]})}export{W as Search};
