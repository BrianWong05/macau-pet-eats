import{s as x,u as y,j as e,a as C}from"./index-CCFjVqBI.js";import{g as G,L as S,r as l}from"./react-vendor-7d_4YsRm.js";import{R as de}from"./index-LfpORLdt.js";import{Q as me,R as ue,V as xe,W as pe,Y as he,x as J,y as K,A as fe,h as be,L as ge,i as je,P as B,H as Q,S as W,e as Y,z as U,a as E,Z,t as u,w as V,_ as ve,X as Ne,$ as ye}from"./ui-vendor-uHOkKSV_.js";import{u as we}from"./useFavorites-DuJztAlP.js";import{R as _e}from"./index-D-pka622.js";import{L as ke}from"./index-LclTNxZ1.js";import"./supabase-K6a4hp2a.js";import"./index-DbodRVV6.js";async function ze(){const{data:{user:t}}=await x.auth.getUser();if(!t)return[];const{data:a,error:i}=await x.from("user_pets").select("*").eq("user_id",t.id).order("created_at",{ascending:!1});return i?(console.error("Error fetching user pets:",i),[]):a||[]}async function Se(t){const{data:{user:a}}=await x.auth.getUser();if(!a)throw new Error("User not authenticated");const{data:i,error:r}=await x.from("user_pets").insert({user_id:a.id,name:t.name,type:t.type.toLowerCase(),size:t.size,breed:t.breed||null,image_url:t.image_url||null}).select().single();if(r)throw console.error("Error creating pet:",r),r;return i}async function Ce(t,a){const{data:{user:i}}=await x.auth.getUser();if(!i)throw new Error("User not authenticated");const r={};a.name!==void 0&&(r.name=a.name),a.type!==void 0&&(r.type=a.type.toLowerCase()),a.size!==void 0&&(r.size=a.size),a.breed!==void 0&&(r.breed=a.breed),a.image_url!==void 0&&(r.image_url=a.image_url);const{data:o,error:m}=await x.from("user_pets").update(r).eq("id",t).eq("user_id",i.id).select().single();if(m)throw console.error("Error updating pet:",m),m;return o}async function Pe(t){const{data:{user:a}}=await x.auth.getUser();if(!a)throw new Error("User not authenticated");const{error:i}=await x.from("user_pets").delete().eq("id",t).eq("user_id",a.id);if(i)throw console.error("Error deleting pet:",i),i;return!0}const Le=["dog","cat","bird","rabbit","other"],Re=[{value:"small",label:"Small (< 10kg)"},{value:"medium",label:"Medium (10-25kg)"},{value:"large",label:"Large (> 25kg)"}],X={dog:he,cat:pe,bird:xe,rabbit:ue,other:me},Ue={small:"S",medium:"M",large:"L"},Ee={small:"bg-green-100 text-green-700",medium:"bg-amber-100 text-amber-700",large:"bg-red-100 text-red-700"};function qe({pet:t,onEdit:a,onDelete:i}){const{t:r}=y(["common"]),o=X[t.type]||X.other;return e.jsxs("div",{className:"bg-white rounded-xl border border-neutral-200 overflow-hidden hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"aspect-square bg-gradient-to-br from-primary-50 to-primary-100 flex items-center justify-center relative",children:[t.image_url?e.jsx("img",{src:t.image_url,alt:t.name,className:"w-full h-full object-cover"}):e.jsx(o,{size:64,className:"text-primary-300"}),e.jsx("span",{className:`absolute top-2 right-2 px-2 py-0.5 rounded-full text-xs font-bold ${Ee[t.size]}`,children:Ue[t.size]})]}),e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsx("h3",{className:"font-semibold text-lg text-neutral-900",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-neutral-500",children:[e.jsx(o,{size:16}),e.jsx("span",{className:"capitalize",children:t.type}),t.breed&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:t.breed})]})]}),(a||i)&&e.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t border-neutral-100",children:[a&&e.jsxs("button",{onClick:()=>a(t),className:"flex-1 inline-flex items-center justify-center gap-1 py-1.5 text-sm text-neutral-600 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",children:[e.jsx(J,{size:14}),r("common:edit")]}),i&&e.jsxs("button",{onClick:()=>i(t.id),className:"flex-1 inline-flex items-center justify-center gap-1 py-1.5 text-sm text-neutral-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[e.jsx(K,{size:14}),r("common:delete")]})]})]})]})}function Fe(){const{t}=y(["profile","restaurant","auth","common"]),{user:a,username:i,signOut:r}=C(),o=G();return e.jsxs("header",{className:"bg-white border-b border-neutral-200 px-4 py-3 flex items-center justify-between shrink-0 z-20 sticky top-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>o(-1),className:"p-2 hover:bg-neutral-100 rounded-xl transition-colors","aria-label":t("restaurant:backToList"),children:e.jsx(fe,{size:20,className:"text-neutral-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-neutral-900",children:i||t("profile:title")}),a?.email&&e.jsx("p",{className:"text-sm text-neutral-500 hidden sm:block",children:a.email})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a&&e.jsxs(e.Fragment,{children:[e.jsx(S,{to:"/profile",className:"p-2 hover:bg-neutral-100 rounded-xl transition-colors text-primary-600",title:t("profile:title"),children:e.jsx(be,{size:20})}),e.jsx("button",{onClick:()=>r(),className:"p-2 hover:bg-neutral-100 rounded-xl transition-colors text-neutral-600 hover:text-red-600",title:t("auth:logout")||"Logout",children:e.jsx(ge,{size:20})})]}),e.jsxs(S,{to:"/submit",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-neutral-200 rounded-xl text-sm font-medium text-neutral-700 hover:bg-neutral-50 transition-colors",children:[e.jsx(je,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:t("common:nav.submit")})]}),e.jsx(ke,{})]})]})}function De(){const{t}=y(["profile","common"]),{username:a,updateUsername:i}=C(),[r,o]=l.useState(!1),[m,h]=l.useState(a||""),[g,b]=l.useState(!1),f=async()=>{if(!m.trim()){u.error(t("profile:usernameRequired"));return}b(!0);const{error:p}=await i(m.trim());b(!1),p?u.error(t("common:error")):(u.success(t("profile:usernameUpdated")),o(!1))};return r?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:m,onChange:p=>h(p.target.value),className:"text-xl font-bold text-neutral-900 border-b-2 border-primary-500 bg-transparent outline-none px-1",placeholder:t("profile:usernamePlaceholder"),autoFocus:!0}),e.jsx("button",{onClick:f,disabled:g,className:"p-1 text-green-600 hover:bg-green-50 rounded-full transition-colors",children:e.jsx(ve,{size:18})}),e.jsx("button",{onClick:()=>{o(!1),h(a||"")},className:"p-1 text-red-600 hover:bg-red-50 rounded-full transition-colors",children:e.jsx(Ne,{size:18})})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-xl font-bold text-neutral-900",children:a||t("profile:setUsername")}),e.jsx("button",{onClick:()=>o(!0),className:"p-1 text-neutral-400 hover:text-primary-600 hover:bg-primary-50 rounded-full transition-colors",title:t("profile:editUsername"),children:e.jsx(ye,{size:16})})]})}function $e(){const{t}=y(["profile","common"]),{user:a,username:i,avatarUrl:r,updateAvatar:o}=C(),[m,h]=l.useState(!1),g=async f=>{const p=f.target.files?.[0];if(!p)return;if(!p.type.startsWith("image/")){u.error(t("common:uploadError"));return}if(p.size>2*1024*1024){u.error(t("profile:avatarTooLarge"));return}h(!0);const{error:j}=await o(p);h(!1),j?u.error(t("common:error")):u.success(t("profile:avatarUpdated"))},b=(i||a?.email?.charAt(0)||"?").charAt(0).toUpperCase();return e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs("label",{className:"relative w-20 h-20 cursor-pointer group",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:g,className:"hidden",disabled:m}),r?e.jsx("img",{src:r,alt:"Avatar",className:"w-20 h-20 rounded-full object-cover border-2 border-neutral-200 group-hover:border-primary-400 transition-colors"}):e.jsx("div",{className:"w-20 h-20 bg-primary-100 rounded-full flex items-center justify-center border-2 border-transparent group-hover:border-primary-400 transition-colors",children:e.jsx("span",{className:"text-2xl font-bold text-primary-600",children:b})}),m?e.jsx("div",{className:"absolute inset-0 bg-black/50 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"})}):e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 rounded-full flex items-center justify-center transition-colors",children:e.jsx(V,{className:"w-6 h-6 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]}),e.jsxs("label",{className:"text-sm text-primary-600 hover:text-primary-700 cursor-pointer font-medium flex items-center gap-1",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:g,className:"hidden",disabled:m}),e.jsx(V,{size:14}),t("profile:changePhoto")]})]})}function Ze(){const{t}=y(["profile","common","submit","feedback","auth"]),{user:a,isLoading:i}=C(),r=G();l.useEffect(()=>{!i&&!a&&r("/")},[a,i,r]);const[o,m]=l.useState("pets"),{favorites:h,isLoading:g}=we(),[b,f]=l.useState([]),[p,j]=l.useState(!0),[_,v]=l.useState(!1),[N,c]=l.useState(null),[q,F]=l.useState([]),[ee,P]=l.useState(!0),[D,$]=l.useState([]),[se,L]=l.useState(!0),[T,A]=l.useState([]),[te,R]=l.useState(!0),[M,k]=l.useState([]),[ae,w]=l.useState(!0),[H,re]=l.useState(null),[I,O]=l.useState(!1);l.useEffect(()=>{(async()=>{if(!a){f([]),j(!1);return}j(!0);const n=await ze();f(n),j(!1)})()},[a]),l.useEffect(()=>{(async()=>{if(!a){F([]),P(!1);return}P(!0);const{data:n,error:d}=await x.from("restaurants").select("*").eq("submitted_by",a.id).order("created_at",{ascending:!1});!d&&n&&F(n),P(!1)})()},[a]),l.useEffect(()=>{(async()=>{if(!a){$([]),L(!1);return}L(!0);const{data:n,error:d}=await x.from("app_feedback").select("*").eq("user_id",a.id).order("created_at",{ascending:!1});!d&&n&&$(n),L(!1)})()},[a]),l.useEffect(()=>{(async()=>{if(!a){A([]),R(!1);return}R(!0);const{data:n,error:d}=await x.from("restaurant_reports").select("*").eq("user_id",a.id).order("created_at",{ascending:!1});!d&&n&&A(n),R(!1)})()},[a]),l.useEffect(()=>{(async()=>{if(!a){k([]),w(!1);return}w(!0);const{data:n,error:d}=await x.from("reviews").select("id, restaurant_id, rating, comment, image_url, images, created_at, is_hidden, admin_comment, restaurants(name, name_zh)").eq("user_id",a.id).order("created_at",{ascending:!1});!d&&n&&k(n),w(!1)})()},[a]);const ne=s=>{re(s),O(!0)},le=async s=>{if(confirm(t("common:confirmDelete")))try{const{error:n}=await x.from("reviews").delete().eq("id",s);if(n)throw n;k(d=>d.filter(z=>z.id!==s)),u.success(t("common:deleteSuccess"))}catch{u.error(t("common:error"))}},ie=()=>{(async()=>{if(!a)return;w(!0);const{data:n,error:d}=await x.from("reviews").select("id, restaurant_id, rating, comment, image_url, images, created_at, is_hidden, admin_comment, restaurants(name, name_zh)").eq("user_id",a.id).order("created_at",{ascending:!1});!d&&n&&k(n),w(!1)})()},oe=async s=>{if(confirm(t("profile:pets.deleteConfirm")))try{await Pe(s),f(n=>n.filter(d=>d.id!==s)),u.success(t("profile:pets.deleted"))}catch{u.error(t("common:error"))}},ce=s=>{c(s),v(!0)};return i?e.jsx("div",{className:"min-h-screen bg-neutral-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"text-neutral-500",children:t("common:loading")})}):a?e.jsxs("div",{className:"min-h-screen bg-neutral-50",children:[e.jsx(Fe,{}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"h-24 sm:h-32 bg-gradient-to-br from-primary-400 via-primary-500 to-amber-400"}),e.jsx("div",{className:"mx-4 -mt-12 sm:-mt-16 bg-white rounded-2xl shadow-lg border border-neutral-100 p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col items-center text-center sm:flex-row sm:text-left sm:items-start gap-3 sm:gap-4",children:[e.jsx($e,{}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(De,{}),e.jsx("p",{className:"text-neutral-500 text-sm truncate",children:a.email})]})]})})]}),e.jsx("div",{className:"px-4 mb-6",children:e.jsx("div",{className:"flex bg-neutral-100 rounded-2xl p-1 overflow-x-auto scrollbar-hide",children:[{key:"pets",icon:B,label:t("profile:tabs.pets")},{key:"favorites",icon:Q,label:t("profile:tabs.favorites")},{key:"contributions",icon:W,label:t("profile:tabs.contributions")},{key:"feedback",icon:Y,label:t("profile:tabs.feedback")},{key:"reports",icon:U,label:t("profile:tabs.reports")},{key:"reviews",icon:E,label:t("profile:tabs.reviews")}].map(s=>e.jsxs("button",{onClick:()=>m(s.key),className:`
                flex-1 min-w-fit flex flex-col items-center gap-1 px-3 py-2.5 sm:px-4 sm:py-3
                text-xs sm:text-sm font-medium rounded-xl transition-all
                ${o===s.key?"bg-white text-primary-600 shadow-sm":"text-neutral-500 hover:text-neutral-700"}
              `,children:[e.jsx(s.icon,{size:18}),e.jsx("span",{className:"truncate w-full text-center leading-tight",children:s.label})]},s.key))})}),e.jsxs("div",{className:"px-4",children:[o==="pets"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:()=>{c(null),v(!0)},className:"inline-flex items-center gap-2 px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white font-medium rounded-xl transition-colors",children:[e.jsx(Z,{size:18}),t("profile:pets.addPet")]}),p?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(s=>e.jsx("div",{className:"aspect-square bg-neutral-200 rounded-xl animate-pulse"},s))}):b.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-neutral-200",children:[e.jsx(B,{size:48,className:"mx-auto text-neutral-300 mb-4"}),e.jsx("p",{className:"text-neutral-600 font-medium",children:t("profile:pets.noPets")}),e.jsx("p",{className:"text-neutral-400 text-sm mt-1",children:t("profile:pets.noPetsHint")})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:b.map(s=>e.jsx(qe,{pet:s,onEdit:ce,onDelete:oe},s.id))})]}),o==="favorites"&&e.jsx("div",{className:"space-y-6",children:g?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(s=>e.jsx("div",{className:"h-64 bg-neutral-200 rounded-xl animate-pulse"},s))}):h.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-neutral-200",children:[e.jsx(Q,{size:48,className:"mx-auto text-neutral-300 mb-4"}),e.jsx("p",{className:"text-neutral-600 font-medium",children:t("profile:favorites.noFavorites")}),e.jsx("p",{className:"text-neutral-400 text-sm mt-1",children:t("profile:favorites.noFavoritesHint")})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(s=>s.restaurant&&e.jsx(_e,{restaurant:s.restaurant},s.restaurant_id))})}),o==="contributions"&&e.jsx("div",{className:"space-y-6",children:ee?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-24 bg-neutral-200 rounded-xl animate-pulse"},s))}):q.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-neutral-200",children:[e.jsx(W,{size:48,className:"mx-auto text-neutral-300 mb-4"}),e.jsx("p",{className:"text-neutral-600 font-medium",children:t("submit:noContributions")}),e.jsx("p",{className:"text-neutral-400 text-sm mt-1",children:t("submit:noContributionsHint")}),e.jsxs(S,{to:"/submit",className:"inline-flex items-center gap-2 mt-4 px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white font-medium rounded-xl transition-colors",children:[e.jsx(Z,{size:18}),t("submit:title")]})]}):e.jsx("div",{className:"space-y-4",children:q.map(s=>e.jsxs("div",{className:"bg-white rounded-xl border border-neutral-200 p-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[s.image_url&&e.jsx("img",{src:s.image_url,alt:s.name_zh||s.name,className:"w-16 h-16 rounded-lg object-cover"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-neutral-900 truncate",children:s.name_zh||s.name||t("common:unnamed")}),e.jsx("p",{className:"text-sm text-neutral-500 truncate",children:s.address_zh||s.address})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium whitespace-nowrap ${s.status==="approved"?"bg-green-100 text-green-700":s.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:s.status==="approved"?t("submit:status.approved"):s.status==="rejected"?t("submit:status.rejected"):t("submit:status.pending")})]}),s.admin_comment&&e.jsxs("div",{className:"mt-3 p-3 bg-neutral-50 rounded-lg border border-neutral-200",children:[e.jsx("p",{className:"text-xs font-medium text-neutral-500 mb-1",children:t("common:adminComment")}),e.jsx("p",{className:"text-sm text-neutral-700",children:s.admin_comment})]})]},s.id))})}),o==="feedback"&&e.jsx("div",{className:"space-y-6",children:se?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-20 bg-neutral-200 rounded-xl animate-pulse"},s))}):D.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-neutral-200",children:[e.jsx(Y,{size:48,className:"mx-auto text-neutral-300 mb-4"}),e.jsx("p",{className:"text-neutral-600 font-medium",children:t("feedback:noFeedback")}),e.jsx("p",{className:"text-neutral-400 text-sm mt-1",children:t("feedback:noFeedbackHint")})]}):e.jsx("div",{className:"space-y-4",children:D.map(s=>e.jsxs("div",{className:"bg-white rounded-xl border border-neutral-200 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${s.type==="bug"?"bg-red-100 text-red-700":s.type==="feature"?"bg-amber-100 text-amber-700":"bg-blue-100 text-blue-700"}`,children:t(`feedback:types.${s.type}`)}),e.jsx("span",{className:"text-xs text-neutral-400",children:new Date(s.created_at).toLocaleDateString()})]}),e.jsx("p",{className:"text-neutral-700 text-sm line-clamp-2",children:s.message})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium whitespace-nowrap ${s.status==="resolved"?"bg-green-100 text-green-700":s.status==="reviewed"?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"}`,children:t(`feedback:status.${s.status}`)})]}),s.admin_comment&&e.jsxs("div",{className:"mt-3 p-3 bg-neutral-50 rounded-lg border border-neutral-200",children:[e.jsx("p",{className:"text-xs font-medium text-neutral-500 mb-1",children:t("common:adminComment")}),e.jsx("p",{className:"text-sm text-neutral-700",children:s.admin_comment})]})]},s.id))})}),o==="reports"&&e.jsx("div",{className:"space-y-6",children:te?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-20 bg-neutral-200 rounded-xl animate-pulse"},s))}):T.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-neutral-200",children:[e.jsx(U,{size:48,className:"mx-auto text-neutral-300 mb-4"}),e.jsx("p",{className:"text-neutral-600 font-medium",children:t("feedback:report.noReports")}),e.jsx("p",{className:"text-neutral-400 text-sm mt-1",children:t("feedback:report.noReportsHint")})]}):e.jsx("div",{className:"space-y-4",children:T.map(s=>e.jsxs("div",{className:"bg-white rounded-xl border border-neutral-200 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:s.field_name}),e.jsx("span",{className:"text-xs text-neutral-400",children:new Date(s.created_at).toLocaleDateString()})]}),e.jsx("p",{className:"text-neutral-600 text-sm truncate",children:s.suggested_value})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium whitespace-nowrap ${s.status==="approved"?"bg-green-100 text-green-700":s.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:t(`feedback:report.status.${s.status}`)})]}),s.admin_comment&&e.jsxs("div",{className:"mt-3 p-3 bg-neutral-50 rounded-lg border border-neutral-200",children:[e.jsx("p",{className:"text-xs font-medium text-neutral-500 mb-1",children:t("common:adminComment")}),e.jsx("p",{className:"text-sm text-neutral-700",children:s.admin_comment})]})]},s.id))})}),o==="reviews"&&e.jsx("div",{className:"space-y-6",children:ae?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-24 bg-neutral-200 rounded-xl animate-pulse"},s))}):M.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-neutral-200",children:[e.jsx(E,{size:48,className:"mx-auto text-neutral-300 mb-4"}),e.jsx("p",{className:"text-neutral-600 font-medium",children:t("profile:reviews.noReviews")}),e.jsx("p",{className:"text-neutral-400 text-sm mt-1",children:t("profile:reviews.noReviewsHint")})]}):e.jsx("div",{className:"space-y-4",children:M.map(s=>e.jsx(S,{to:`/restaurant/${s.restaurant_id}`,className:"block bg-white rounded-xl border border-neutral-200 p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"font-medium text-neutral-900 mb-1",children:[s.restaurants?.name_zh||s.restaurants?.name||t("common:unknown"),s.is_hidden&&e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-red-100 text-red-600 text-xs rounded-full",children:t("common:hidden")})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"flex",children:[1,2,3,4,5].map(n=>e.jsx(E,{size:14,className:n<=s.rating?"text-amber-400 fill-amber-400":"text-neutral-300"},n))}),e.jsx("span",{className:"text-xs text-neutral-400",children:new Date(s.created_at).toLocaleDateString()})]}),s.comment&&e.jsx("p",{className:"text-sm text-neutral-600 line-clamp-2",children:s.comment}),s.images&&s.images.length>0?e.jsx("div",{className:"mt-3 flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:s.images.map((n,d)=>e.jsx("img",{src:n,alt:"Review photo",className:"h-20 w-20 object-cover rounded-lg border border-neutral-200 flex-shrink-0"},d))}):s.image_url&&e.jsx("div",{className:"mt-3",children:e.jsx("img",{src:s.image_url,alt:"Review photo",className:"h-20 w-20 object-cover rounded-lg border border-neutral-200"})}),s.is_hidden&&s.admin_comment&&e.jsxs("div",{className:"mt-3 p-3 bg-red-50 rounded-lg border border-red-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(U,{size:14,className:"text-red-500"}),e.jsx("p",{className:"text-xs font-medium text-red-700",children:t("common:adminComment")})]}),e.jsx("p",{className:"text-sm text-red-800",children:s.admin_comment})]})]}),e.jsx("button",{onClick:n=>{n.preventDefault(),ne(s)},className:"p-2 text-neutral-400 hover:text-primary-500 hover:bg-primary-50 rounded-full transition-colors",title:t("common:edit"),children:e.jsx(J,{size:18})}),e.jsx("button",{onClick:n=>{n.preventDefault(),le(s.id)},className:"p-2 text-neutral-400 hover:text-red-600 hover:bg-red-50 rounded-full transition-colors",title:t("common:delete"),children:e.jsx(K,{size:18})})]})},s.id))})}),I&&H&&e.jsx(de,{isOpen:I,onClose:()=>O(!1),onSuccess:ie,review:H}),_&&e.jsx(Te,{pet:N,onClose:()=>{v(!1),c(null)},onSave:async s=>{try{if(N){const n=await Ce(N.id,s);f(d=>d.map(z=>z.id===N.id?n:z)),u.success(t("profile:pets.updated"))}else{const n=await Se(s);f(d=>[n,...d]),u.success(t("profile:pets.added"))}v(!1),c(null)}catch{u.error(t("common:error"))}}})]})]}):null}function Te({pet:t,onClose:a,onSave:i}){const{t:r}=y(["profile","common"]),[o,m]=l.useState(t?.name||""),[h,g]=l.useState(t?.type||"dog"),[b,f]=l.useState(t?.size||"medium"),[p,j]=l.useState(t?.breed||""),[_,v]=l.useState(!1),N=async c=>{if(c.preventDefault(),!o.trim()){u.error(r("profile:pets.namePlaceholder"));return}v(!0),await i({name:o,type:h,size:b,breed:p||null}),v(!1)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6 space-y-6",children:[e.jsx("h2",{className:"text-xl font-bold text-neutral-900",children:r(t?"profile:pets.editPet":"profile:pets.addPet")}),e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700",children:r("profile:pets.name")}),e.jsx("input",{type:"text",value:o,onChange:c=>m(c.target.value),placeholder:r("profile:pets.namePlaceholder"),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700",children:r("profile:pets.type")}),e.jsx("select",{value:h,onChange:c=>g(c.target.value),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500",children:Le.map(c=>e.jsx("option",{value:c,children:r(`profile:pets.types.${c}`)},c))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700",children:r("profile:pets.size")}),e.jsx("select",{value:b,onChange:c=>f(c.target.value),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500",children:Re.map(c=>e.jsx("option",{value:c.value,children:r(`profile:pets.sizes.${c.value}`)},c.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700",children:r("profile:pets.breed")}),e.jsx("input",{type:"text",value:p,onChange:c=>j(c.target.value),placeholder:r("profile:pets.breedPlaceholder"),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-2 text-neutral-600 hover:bg-neutral-100 rounded-xl transition-colors",children:r("common:cancel")}),e.jsx("button",{type:"submit",disabled:_,className:"flex-1 px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white font-medium rounded-xl transition-colors disabled:opacity-50",children:r(_?"common:loading":"common:save")})]})]})]})})}export{Ze as Profile};
