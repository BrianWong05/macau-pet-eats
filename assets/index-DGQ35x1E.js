import{u as m,j as e,s as n}from"./index-Cv61YdKj.js";import{g as p,r as l}from"./react-vendor-7d_4YsRm.js";import{S as w,J as k,s as y,u as S,a4 as C,a5 as T,M as _,d as A,B as L}from"./ui-vendor-BMPxCYOj.js";import"./supabase-K6a4hp2a.js";function E({stats:a,isLoading:o}){const{t:s}=m(["admin"]),c=p(),d=[{label:s("admin:dashboard.totalRestaurants")||"Total Restaurants",value:a.totalRestaurants,icon:w,color:"bg-blue-500",path:"/admin/restaurants"},{label:s("admin:dashboard.activeListings")||"Active Listings",value:a.activeRestaurants,icon:k,color:"bg-green-500",path:"/admin/restaurants"},{label:s("admin:dashboard.pendingApproval")||"Pending Approval",value:a.pendingRestaurants,icon:y,color:"bg-amber-500",path:"/admin/restaurants"},{label:s("admin:dashboard.updateReports")||"Update Reports",value:a.pendingReports,icon:S,color:"bg-orange-500",path:"/admin/reports"},{label:s("admin:dashboard.totalReviews")||"Total Reviews",value:a.totalReviews,icon:C,color:"bg-purple-500",path:"/admin/reviews"}];return o?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-5 gap-4 lg:gap-6",children:[1,2,3,4,5].map(t=>e.jsx("div",{className:"h-32 bg-white rounded-2xl shadow-sm animate-pulse"},t))}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-5 gap-4 lg:gap-6",children:d.map(t=>e.jsx("div",{onClick:()=>t.path&&c(t.path),className:`bg-white p-6 rounded-2xl shadow-sm border border-neutral-100 transition-all ${t.path?"cursor-pointer hover:shadow-md active:scale-95":""}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-neutral-500 mb-1",children:t.label}),e.jsx("h3",{className:"text-3xl font-bold text-neutral-900",children:t.value})]}),e.jsx("div",{className:`p-3 rounded-xl ${t.color} bg-opacity-10`,children:e.jsx(t.icon,{className:`w-6 h-6 ${t.color.replace("bg-","text-")}`})})]})},t.label))})}const q={bug:L,feature:A,general:_},F={bug:"text-red-500 bg-red-50",feature:"text-amber-500 bg-amber-50",general:"text-blue-500 bg-blue-50"};function D(){const{t:a}=m(["admin","common"]),o=p(),[s,c]=l.useState({totalRestaurants:0,activeRestaurants:0,pendingRestaurants:0,pendingReports:0,totalReviews:0}),[d,t]=l.useState([]),[u,x]=l.useState(0),[g,b]=l.useState(!0);return l.useEffect(()=>{async function r(){try{const[{count:i},{count:h},{count:v},{count:f},{count:j},{data:N},{count:R}]=await Promise.all([n.from("restaurants").select("*",{count:"exact",head:!0}),n.from("restaurants").select("*",{count:"exact",head:!0}).eq("status","approved"),n.from("restaurants").select("*",{count:"exact",head:!0}).eq("status","pending"),n.from("restaurant_reports").select("*",{count:"exact",head:!0}).eq("status","pending"),n.from("reviews").select("*",{count:"exact",head:!0}),n.from("app_feedback").select("id, type, message, status, created_at").order("created_at",{ascending:!1}).limit(3),n.from("app_feedback").select("*",{count:"exact",head:!0}).eq("status","pending")]);c({totalRestaurants:i||0,activeRestaurants:h||0,pendingRestaurants:v||0,pendingReports:f||0,totalReviews:j||0}),t(N||[]),x(R||0)}catch(i){console.error("Error fetching stats:",i)}finally{b(!1)}}r()},[]),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-neutral-900 mb-8",children:a("admin:dashboard.title")}),e.jsx(E,{stats:s,isLoading:g}),e.jsxs("div",{className:"mt-8 bg-white rounded-2xl border border-neutral-200 overflow-hidden",children:[e.jsxs("div",{className:"p-5 border-b border-neutral-100 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-neutral-900",children:a("admin:feedback.title")||"User Feedback"}),u>0&&e.jsxs("p",{className:"text-sm text-neutral-500 mt-0.5",children:[u," ",a("admin:feedback.status.pending")||"pending"]})]}),e.jsxs("button",{onClick:()=>o("/admin/feedback"),className:"text-sm text-primary-500 hover:text-primary-600 font-medium flex items-center gap-1",children:[a("common:viewAll")||"View All",e.jsx(T,{size:16})]})]}),d.length===0?e.jsx("div",{className:"p-8 text-center text-neutral-400",children:a("admin:feedback.empty")||"No feedback yet"}):e.jsx("div",{className:"divide-y divide-neutral-100",children:d.map(r=>{const i=q[r.type];return e.jsxs("div",{className:"p-4 flex items-start gap-3 hover:bg-neutral-50 transition-colors",children:[e.jsx("div",{className:`p-2 rounded-lg ${F[r.type]}`,children:e.jsx(i,{size:16})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-neutral-900 line-clamp-2",children:r.message}),e.jsx("p",{className:"text-xs text-neutral-400 mt-1",children:new Date(r.created_at).toLocaleDateString()})]})]},r.id)})})]})]})}export{D as AdminDashboard};
