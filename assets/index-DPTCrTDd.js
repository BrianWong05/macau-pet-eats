import{u,j as e}from"./index-da4C4Nok.js";import{L as p,r as d}from"./react-vendor-B-2HpIm1.js";import{u as v}from"./useRestaurants-Du2-ZaRd.js";import{L as y}from"./index-DvGUM6NA.js";import{A as k,m as _,h as z,X as S,U as C,l as g}from"./ui-vendor-BzBFCVgS.js";import{g as x,P}from"./index-HlvzkroW.js";import{M as L,T as R,a as T,l as M,P as $}from"./map-vendor-CGtvAa0a.js";import"./supabase-K6a4hp2a.js";function E({filteredCount:s,showFilters:n,setShowFilters:a,hasActiveFilters:t}){const{t:l}=u();return e.jsxs("header",{className:"bg-white border-b border-neutral-200 px-4 py-3 flex items-center justify-between shrink-0 z-20",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(p,{to:"/",className:"p-2 hover:bg-neutral-100 rounded-xl transition-colors","aria-label":l("restaurant.backToList"),children:e.jsx(k,{size:20,className:"text-neutral-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-neutral-900",children:l("explore.title")}),e.jsx("p",{className:"text-sm text-neutral-500 hidden sm:block",children:l("explore.results",{count:s})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>a(!n),className:`
            inline-flex items-center gap-2 px-3 py-2
            rounded-xl border text-sm font-medium
            transition-all
            ${t?"bg-primary-50 border-primary-200 text-primary-700":"bg-white border-neutral-200 text-neutral-700 hover:bg-neutral-50"}
          `,children:[e.jsx(_,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:l("explore.filters.petPolicy")}),t&&e.jsx("span",{className:"w-2 h-2 bg-primary-500 rounded-full"})]}),e.jsxs(p,{to:"/submit",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-neutral-200 rounded-xl text-sm font-medium text-neutral-700 hover:bg-neutral-50 transition-colors",children:[e.jsx(z,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:l("nav.submit")})]}),e.jsx(y,{})]})]})}const A=["indoors_allowed","patio_only","small_pets_only","all_pets_welcome","dogs_only","cats_only"];function U({petPolicyFilter:s,setPetPolicyFilter:n,cuisineFilter:a,setCuisineFilter:t,cuisineTypes:l,clearFilters:c,hasActiveFilters:i}){const{t:o,i18n:h}=u(),m=h.language;return e.jsx("div",{className:"bg-white border-b border-neutral-200 px-4 py-4 shrink-0 z-10 animate-fade-in",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700 mb-2 block",children:o("explore.filters.petPolicy")}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>n(null),className:`
                px-3 py-1.5 rounded-full text-sm font-medium
                transition-all
                ${s?"bg-neutral-100 text-neutral-600 hover:bg-neutral-200":"bg-primary-500 text-white"}
              `,children:o("explore.filters.all")}),A.map(r=>e.jsx("button",{onClick:()=>n(r),className:`
                  px-3 py-1.5 rounded-full text-sm font-medium
                  transition-all
                  ${s===r?"bg-primary-500 text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                `,children:o(`petPolicy.${r}`)},r))]})]}),l.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700 mb-2 block",children:o("explore.filters.cuisine")}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>t(null),className:`
                  px-3 py-1.5 rounded-full text-sm font-medium
                  transition-all
                  ${a?"bg-neutral-100 text-neutral-600 hover:bg-neutral-200":"bg-secondary-500 text-white"}
                `,children:o("explore.filters.all")}),l.map(r=>e.jsx("button",{onClick:()=>t(r.name),className:`
                    px-3 py-1.5 rounded-full text-sm font-medium
                    transition-all
                    ${a===r.name?"bg-secondary-500 text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                  `,children:m==="zh"?r.name_zh||r.name:m==="pt"&&r.name_pt||r.name},r.id))]})]}),i&&e.jsxs("button",{onClick:c,className:"inline-flex items-center gap-1.5 text-sm text-neutral-500 hover:text-neutral-700",children:[e.jsx(S,{size:14}),"Clear filters"]})]})})}function F({restaurant:s,lang:n,isSelected:a,onSelect:t}){const l=x(s,"name",n),c=x(s,"address",n),i=x(s,"cuisine_type",n);return e.jsx(p,{to:`/restaurant/${s.id}`,onClick:t,className:`
        block p-4 hover:bg-neutral-50 transition-colors
        ${a?"bg-primary-50 border-l-4 border-primary-500":""}
      `,children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("img",{src:s.image_url||"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=200",alt:l,className:"w-20 h-20 rounded-xl object-cover shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-neutral-900 truncate mb-1",children:l}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-neutral-500 mb-2",children:[e.jsx(C,{size:14}),e.jsx("span",{children:i})]}),e.jsx(P,{policy:s.pet_policy,size:"sm"}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-neutral-400 mt-2",children:[e.jsx(g,{size:12}),e.jsx("span",{className:"truncate",children:c})]})]})]})})}function I({isLoading:s,filteredRestaurants:n,selectedRestaurant:a,onSelectRestaurant:t,lang:l}){const{t:c}=u();return e.jsx("div",{className:"w-full md:w-96 lg:w-[420px] bg-white border-r border-neutral-200 overflow-y-auto shrink-0",children:s?e.jsx("div",{className:"p-4 space-y-4",children:Array.from({length:5}).map((i,o)=>e.jsx("div",{className:"animate-shimmer h-24 rounded-xl"},o))}):n.length===0?e.jsxs("div",{className:"p-8 text-center text-neutral-500",children:[e.jsx(g,{className:"w-12 h-12 mx-auto mb-4 text-neutral-300"}),e.jsx("p",{children:c("explore.noResults")})]}):e.jsx("div",{className:"divide-y divide-neutral-100",children:n.map(i=>e.jsx(F,{restaurant:i,lang:l,isSelected:a===i.id,onSelect:()=>t(i.id)},i.id))})})}function O({restaurant:s,lang:n}){const{t:a}=u(),t=x(s,"name",n),l=x(s,"cuisine_type",n);return e.jsxs("div",{className:"min-w-[200px]",children:[e.jsx("img",{src:s.image_url||"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=300",alt:t,className:"w-full h-24 object-cover rounded-lg mb-2"}),e.jsx("h3",{className:"font-semibold text-neutral-900 mb-1",children:t}),e.jsx("p",{className:"text-sm text-neutral-500 mb-2",children:l}),e.jsx(p,{to:`/restaurant/${s.id}`,className:"block w-full text-center px-3 py-2 bg-primary-500 text-white text-sm font-medium rounded-lg hover:bg-primary-600 transition-colors",children:a("explore.viewDetails")})]})}const B=new M.Icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),H=[22.1987,113.5439];function D({filteredRestaurants:s,onSelectRestaurant:n,lang:a}){return e.jsx("div",{className:"hidden md:block flex-1 relative",children:e.jsxs(L,{center:H,zoom:14,className:"h-full w-full",zoomControl:!1,children:[e.jsx(R,{attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),s.map(t=>e.jsx(T,{position:[t.latitude,t.longitude],icon:B,eventHandlers:{click:()=>n(t.id)},children:e.jsx($,{children:e.jsx(O,{restaurant:t,lang:a})})},t.id))]})})}function W(){const{i18n:s}=u(),n=s.language,[a,t]=d.useState(null),[l,c]=d.useState(null),[i,o]=d.useState(!1),[h,m]=d.useState(null),{restaurants:r,cuisineTypes:j,isLoading:N}=v({petPolicyFilter:a,cuisineFilters:l?[l]:void 0}),b=d.useMemo(()=>r,[r]),w=()=>{t(null),c(null)},f=a||l;return e.jsxs("div",{className:"h-screen flex flex-col bg-neutral-50",children:[e.jsx(E,{filteredCount:b.length,showFilters:i,setShowFilters:o,hasActiveFilters:f}),i&&e.jsx(U,{petPolicyFilter:a,setPetPolicyFilter:t,cuisineFilter:l,setCuisineFilter:c,cuisineTypes:j,clearFilters:w,hasActiveFilters:f}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx(I,{isLoading:N,filteredRestaurants:b,selectedRestaurant:h,onSelectRestaurant:m,lang:n}),e.jsx(D,{filteredRestaurants:b,onSelectRestaurant:m,lang:n})]})]})}export{W as Explore};
