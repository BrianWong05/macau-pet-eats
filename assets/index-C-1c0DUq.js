import{u as E,j as e,s as f}from"./index-BEnJpxrS.js";import{r as a}from"./react-vendor-7d_4YsRm.js";import{M as z,c as F,B as I,aa as M,z as O,r as A,X as L,t as j}from"./ui-vendor-f2-SRabJ.js";import{P as T}from"./index-WIS02uwr.js";import"./supabase-K6a4hp2a.js";const R={bug:I,feature:F,general:z},$={bug:"text-red-500 bg-red-50",feature:"text-amber-500 bg-amber-50",general:"text-blue-500 bg-blue-50"},q={pending:"bg-amber-100 text-amber-700",reviewed:"bg-blue-100 text-blue-700",resolved:"bg-green-100 text-green-700"},B=[10,25,50,100];function X(){const{t:s}=E(["admin","search","common"]),[l,v]=a.useState([]),[N,p]=a.useState(!0),[c,k]=a.useState("all"),[o,b]=a.useState(1),[r,y]=a.useState(25),[d,i]=a.useState(null),[g,u]=a.useState(""),h=async()=>{p(!0);let t=f.from("app_feedback").select("*").order("created_at",{ascending:!1});c!=="all"&&(t=t.eq("status",c));const{data:n,error:x}=await t;!x&&n&&v(n),p(!1)};a.useEffect(()=>{h()},[c]),a.useEffect(()=>{b(1)},[c,r]);const w=Math.ceil(l.length/r),S=a.useMemo(()=>{const t=(o-1)*r;return l.slice(t,t+r)},[l,o,r]),C=async(t,n,x)=>{const{error:_}=await f.from("app_feedback").update({status:n,admin_comment:x||null,updated_at:new Date().toISOString()}).eq("id",t);_?j.error("Failed to update status"):(j.success(s("admin:feedback.statusUpdated")||"Status updated"),h())},m=(t,n)=>{i({id:t,status:n}),u("")},P=()=>{d&&(C(d.id,d.status,g||void 0),i(null),u(""))};return e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-neutral-900",children:s("admin:feedback.title")||"User Feedback"}),e.jsx("p",{className:"text-neutral-500 mt-1",children:s("admin:feedback.subtitle")||"View and manage user feedback"})]})}),e.jsx("div",{className:"flex gap-2 mb-6",children:["all","pending","reviewed","resolved"].map(t=>e.jsx("button",{onClick:()=>k(t),className:`px-4 py-2 rounded-lg font-medium text-sm transition-colors ${c===t?"bg-primary-500 text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}`,children:s(`admin:feedback.status.${t}`)||t},t))}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("p",{className:"text-sm text-neutral-500",children:s("search:results",{count:l.length})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{htmlFor:"feedback-page-size",className:"text-sm text-neutral-500",children:[s("search:perPage"),":"]}),e.jsx("select",{id:"feedback-page-size",value:r,onChange:t=>y(Number(t.target.value)),className:"px-3 py-1.5 text-sm border border-neutral-200 rounded-lg bg-white focus:ring-2 focus:ring-primary-500",children:B.map(t=>e.jsx("option",{value:t,children:t},t))})]})]}),e.jsx("div",{className:"space-y-4",children:N?e.jsx("div",{className:"text-center py-12 text-neutral-500",children:"Loading..."}):l.length===0?e.jsx("div",{className:"text-center py-12 text-neutral-500",children:s("admin:feedback.empty")||"No feedback yet"}):S.map(t=>{const n=R[t.type];return e.jsx("div",{className:"bg-white rounded-xl border border-neutral-200 p-5",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:`p-2 rounded-lg ${$[t.type]}`,children:e.jsx(n,{size:18})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${q[t.status]}`,children:s(`admin:feedback.status.${t.status}`)||t.status}),e.jsx("span",{className:"text-xs text-neutral-400",children:new Date(t.created_at).toLocaleString()})]}),e.jsx("p",{className:"text-neutral-900 whitespace-pre-wrap",children:t.message}),t.contact_email&&e.jsxs("p",{className:"text-sm text-neutral-500 mt-2",children:["ðŸ“§ ",t.contact_email]}),t.page_url&&e.jsxs("p",{className:"text-xs text-neutral-400 mt-1 truncate",children:["ðŸ“ ",t.page_url]})]})]}),e.jsxs("div",{className:"flex gap-1",children:[t.status!=="reviewed"&&e.jsx("button",{onClick:()=>m(t.id,"reviewed"),className:"p-2 text-blue-500 hover:bg-blue-50 rounded-lg transition-colors",title:"Mark as Reviewed",children:e.jsx(M,{size:18})}),t.status!=="resolved"&&e.jsx("button",{onClick:()=>m(t.id,"resolved"),className:"p-2 text-green-500 hover:bg-green-50 rounded-lg transition-colors",title:"Mark as Resolved",children:e.jsx(O,{size:18})}),t.status!=="pending"&&e.jsx("button",{onClick:()=>m(t.id,"pending"),className:"p-2 text-amber-500 hover:bg-amber-50 rounded-lg transition-colors",title:"Mark as Pending",children:e.jsx(A,{size:18})})]})]})},t.id)})}),e.jsx(T,{currentPage:o,totalPages:w,onPageChange:b}),d&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-5 border-b border-neutral-100 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:s("admin:comment.title")||"Add Comment"}),e.jsx("button",{onClick:()=>i(null),className:"p-2 hover:bg-neutral-100 rounded-full transition-colors",children:e.jsx(L,{size:18,className:"text-neutral-500"})})]}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-neutral-600 mb-2",children:s("admin:comment.hint")||"Add a comment for the user (optional)"}),e.jsx("textarea",{value:g,onChange:t=>u(t.target.value),placeholder:s("admin:comment.placeholder")||"Enter your response...",rows:3,className:"w-full px-4 py-3 border border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 resize-none"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>i(null),className:"flex-1 px-4 py-2 border border-neutral-200 rounded-xl font-medium text-neutral-600 hover:bg-neutral-50 transition-colors",children:s("common:cancel")}),e.jsx("button",{onClick:P,className:"flex-1 px-4 py-2 bg-primary-500 text-white rounded-xl font-medium hover:bg-primary-600 transition-colors",children:s("common:submit")})]})]})]})})]})}export{X as AdminFeedback};
