import{u as p,j as e,b as v}from"./index-Cv61YdKj.js";import{L as h,r as x}from"./react-vendor-7d_4YsRm.js";import{u as y}from"./useRestaurants-ZUVDPc8w.js";import{L as k}from"./index-BGr7p4pF.js";import{A as _,n as z,i as P,X as S,U as C,m as N}from"./ui-vendor-BMPxCYOj.js";import{g as u,P as L}from"./index-CQXZkmI7.js";import{M as R,T as M,a as T,l as $,P as A}from"./map-vendor-EqXDY7eA.js";import"./supabase-K6a4hp2a.js";function E({filteredCount:s,showFilters:n,setShowFilters:r,hasActiveFilters:t}){const{t:l}=p(["explore","restaurant","common"]);return e.jsxs("header",{className:"bg-white border-b border-neutral-200 px-4 py-3 flex items-center justify-between shrink-0 z-20",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(h,{to:"/",className:"p-2 hover:bg-neutral-100 rounded-xl transition-colors","aria-label":l("restaurant:backToList"),children:e.jsx(_,{size:20,className:"text-neutral-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-neutral-900",children:l("explore:title")}),e.jsx("p",{className:"text-sm text-neutral-500 hidden sm:block",children:l("explore:results",{count:s})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>r(!n),className:`
            inline-flex items-center gap-2 px-3 py-2
            rounded-xl border text-sm font-medium
            transition-all
            ${t?"bg-primary-50 border-primary-200 text-primary-700":"bg-white border-neutral-200 text-neutral-700 hover:bg-neutral-50"}
          `,children:[e.jsx(z,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:l("explore:filters.petPolicy")}),t&&e.jsx("span",{className:"w-2 h-2 bg-primary-500 rounded-full"})]}),e.jsxs(h,{to:"/submit",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-neutral-200 rounded-xl text-sm font-medium text-neutral-700 hover:bg-neutral-50 transition-colors",children:[e.jsx(P,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:l("common:nav.submit")})]}),e.jsx(k,{})]})]})}function U({petPolicyFilter:s,setPetPolicyFilter:n,cuisineFilter:r,setCuisineFilter:t,cuisineTypes:l,clearFilters:o,hasActiveFilters:i}){const{t:c,i18n:g}=p(),m=g.language,{petPolicies:d,getPetPolicyDisplayName:b}=v(),f=d.length>0?d.map(a=>a.name):["indoors_allowed","patio_only","small_pets_only","all_pets_welcome","dogs_only","cats_only","medium_dogs_allowed"];return e.jsx("div",{className:"bg-white border-b border-neutral-200 px-4 py-4 shrink-0 z-10 animate-fade-in",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700 mb-2 block",children:c("explore.filters.petPolicy")}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>n(null),className:`
                px-3 py-1.5 rounded-full text-sm font-medium
                transition-all
                ${s?"bg-neutral-100 text-neutral-600 hover:bg-neutral-200":"bg-primary-500 text-white"}
              `,children:c("explore.filters.all")}),f.map(a=>e.jsx("button",{onClick:()=>n(a),className:`
                  px-3 py-1.5 rounded-full text-sm font-medium
                  transition-all
                  ${s===a?"bg-primary-500 text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                `,children:b(a,m)},a))]})]}),l.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700 mb-2 block",children:c("explore.filters.cuisine")}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>t(null),className:`
                  px-3 py-1.5 rounded-full text-sm font-medium
                  transition-all
                  ${r?"bg-neutral-100 text-neutral-600 hover:bg-neutral-200":"bg-secondary-500 text-white"}
                `,children:c("explore.filters.all")}),l.map(a=>e.jsx("button",{onClick:()=>t(a.name),className:`
                    px-3 py-1.5 rounded-full text-sm font-medium
                    transition-all
                    ${r===a.name?"bg-secondary-500 text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}
                  `,children:m==="zh"?a.name_zh||a.name:m==="pt"&&a.name_pt||a.name},a.id))]})]}),i&&e.jsxs("button",{onClick:o,className:"inline-flex items-center gap-1.5 text-sm text-neutral-500 hover:text-neutral-700",children:[e.jsx(S,{size:14}),"Clear filters"]})]})})}function F({restaurant:s,lang:n,isSelected:r,onSelect:t}){const l=u(s,"name",n),o=u(s,"address",n),i=u(s,"cuisine_type",n);return e.jsx(h,{to:`/restaurant/${s.id}`,onClick:t,className:`
        block p-4 hover:bg-neutral-50 transition-colors
        ${r?"bg-primary-50 border-l-4 border-primary-500":""}
      `,children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("img",{src:s.image_url||"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=200",alt:l,className:"w-20 h-20 rounded-xl object-cover shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-neutral-900 truncate mb-1",children:l}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-neutral-500 mb-2",children:[e.jsx(C,{size:14}),e.jsx("span",{children:i})]}),e.jsx(L,{policy:s.pet_policy,size:"sm"}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-neutral-400 mt-2",children:[e.jsx(N,{size:12}),e.jsx("span",{className:"truncate",children:o})]})]})]})})}function I({isLoading:s,filteredRestaurants:n,selectedRestaurant:r,onSelectRestaurant:t,lang:l}){const{t:o}=p(["explore"]);return e.jsx("div",{className:"w-full md:w-96 lg:w-[420px] bg-white border-r border-neutral-200 overflow-y-auto shrink-0",children:s?e.jsx("div",{className:"p-4 space-y-4",children:Array.from({length:5}).map((i,c)=>e.jsx("div",{className:"animate-shimmer h-24 rounded-xl"},c))}):n.length===0?e.jsxs("div",{className:"p-8 text-center text-neutral-500",children:[e.jsx(N,{className:"w-12 h-12 mx-auto mb-4 text-neutral-300"}),e.jsx("p",{children:o("explore:noResults")})]}):e.jsx("div",{className:"divide-y divide-neutral-100",children:n.map(i=>e.jsx(F,{restaurant:i,lang:l,isSelected:r===i.id,onSelect:()=>t(i.id)},i.id))})})}function B({restaurant:s,lang:n}){const{t:r}=p(["explore"]),t=u(s,"name",n),l=u(s,"cuisine_type",n);return e.jsxs("div",{className:"min-w-[200px]",children:[e.jsx("img",{src:s.image_url||"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=300",alt:t,className:"w-full h-24 object-cover rounded-lg mb-2"}),e.jsx("h3",{className:"font-semibold text-neutral-900 mb-1",children:t}),e.jsx("p",{className:"text-sm text-neutral-500 mb-2",children:l}),e.jsx(h,{to:`/restaurant/${s.id}`,className:"block w-full text-center px-3 py-2 bg-primary-500 text-white text-sm font-medium rounded-lg hover:bg-primary-600 transition-colors",children:r("explore:viewDetails")})]})}const D=new $.Icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),H=[22.1987,113.5439];function O({filteredRestaurants:s,onSelectRestaurant:n,lang:r}){return e.jsx("div",{className:"hidden md:block flex-1 relative",children:e.jsxs(R,{center:H,zoom:14,className:"h-full w-full",zoomControl:!1,children:[e.jsx(M,{attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),s.map(t=>e.jsx(T,{position:[t.latitude,t.longitude],icon:D,eventHandlers:{click:()=>n(t.id)},children:e.jsx(A,{children:e.jsx(B,{restaurant:t,lang:r})})},t.id))]})})}function Y(){const{i18n:s}=p(),n=s.language,[r,t]=x.useState(null),[l,o]=x.useState(null),[i,c]=x.useState(!1),[g,m]=x.useState(null),{restaurants:d,cuisineTypes:b,isLoading:f}=y({petPolicyFilter:r,cuisineFilters:l?[l]:void 0}),a=x.useMemo(()=>d,[d]),w=()=>{t(null),o(null)},j=r||l;return e.jsxs("div",{className:"h-screen flex flex-col bg-neutral-50",children:[e.jsx(E,{filteredCount:a.length,showFilters:i,setShowFilters:c,hasActiveFilters:j}),i&&e.jsx(U,{petPolicyFilter:r,setPetPolicyFilter:t,cuisineFilter:l,setCuisineFilter:o,cuisineTypes:b,clearFilters:w,hasActiveFilters:j}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx(I,{isLoading:f,filteredRestaurants:a,selectedRestaurant:g,onSelectRestaurant:m,lang:n}),e.jsx(O,{filteredRestaurants:a,onSelectRestaurant:m,lang:n})]})]})}export{Y as Explore};
