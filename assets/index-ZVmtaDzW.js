import{u as le,b as oe,j as e,s as C}from"./index-8xtluKpC.js";import{r as h}from"./react-vendor-7d_4YsRm.js";import{X as E,s as ie,m as ce,D as de,i as S,u as ue,c as me,t as b}from"./ui-vendor-uHOkKSV_.js";function pe(g){const p=[/!3d(-?\d+\.?\d*)!4d(-?\d+\.?\d*)/,/[?&]q=(-?\d+\.?\d*),(-?\d+\.?\d*)/,/place\/(-?\d+\.?\d*),(-?\d+\.?\d*)/,/@(-?\d+\.?\d*),(-?\d+\.?\d*)/];for(const y of p){const d=g.match(y);if(d){const r=parseFloat(d[1]),x=parseFloat(d[2]);if(!isNaN(r)&&!isNaN(x)&&r>=-90&&r<=90&&x>=-180&&x<=180)return{lat:r,lng:x}}}return null}function xe(g){const p=g.match(/\/place\/([^/@]+)/);if(p)return decodeURIComponent(p[1].replace(/\+/g," "));const y=g.match(/[?&]q=([^&]+)/);return y?decodeURIComponent(y[1].replace(/\+/g," ")):null}function he(g){const p=g.match(/!1s(0x[a-f0-9]+:0x[a-f0-9]+)/);return p?p[1]:null}function ge(g,p,y,d,r="zh"){const x={zh:"zh-TW",en:"en",pt:"pt-PT"}[r]||"zh-TW";if(g){const v=he(g);if(v){const z=v.match(/:0x([a-f0-9]+)$/);if(z)return`https://maps.google.com/maps?cid=${BigInt("0x"+z[1]).toString()}&z=17&output=embed&hl=${x}`}const k=xe(g);if(k)return`https://maps.google.com/maps?q=${encodeURIComponent(k)}&ll=${p},${y}&z=17&output=embed&hl=${x}`}if(d){const v=`${d} Macau`;return`https://maps.google.com/maps?q=${encodeURIComponent(v)}&ll=${p},${y}&z=17&output=embed&hl=${x}`}return`https://maps.google.com/maps?q=${p},${y}&z=15&output=embed&hl=${x}`}const Q=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];function je({isOpen:g,onClose:p,onSave:y,restaurant:d}){const{t:r,i18n:x}=le(["admin","common","submit","restaurant","explore"]),v=x.language,{petPolicies:k,getPetPolicyDisplayName:z}=oe(),[P,I]=h.useState(!1),[q,D]=h.useState(null),[F,O]=h.useState(""),[U,X]=h.useState([]),[_,N]=h.useState([]),[W,H]=h.useState(""),M=h.useRef(null),[A,R]=h.useState([]),[B,w]=h.useState([]),[G,V]=h.useState(""),$=h.useRef(null);h.useEffect(()=>{(async()=>{const{data:s}=await C.from("cuisine_types").select("*").order("sort_order",{ascending:!0});s&&X(s)})()},[]);const Y=t=>{O(t);const s=pe(t);s?(c(l=>({...l,latitude:s.lat,longitude:s.lng,google_maps_url:t})),b.success("Location extracted from URL!")):t&&c(l=>({...l,google_maps_url:t}))},[n,c]=h.useState({name:"",name_zh:"",name_pt:"",address:"",address_zh:"",address_pt:"",description:"",description_zh:"",description_pt:"",pet_policy:"patio_only",cuisine_type:[],contact_info:"",image_url:"",gallery_images:[],menu_images:[],latitude:22.1937,longitude:113.5399,status:"approved"});h.useEffect(()=>{if(d){if(c(d),O(d.google_maps_url||""),d.cuisine_type&&d.cuisine_type.length>0&&U.length>0){const s=U.map(a=>a.name.toLowerCase()),l=d.cuisine_type.find(a=>!s.includes(a.toLowerCase())&&a!=="Other");if(l){const a=d.cuisine_type.map(o=>o===l?"Other":o);c(o=>({...o,cuisine_type:a,cuisine_type_other:l}))}}let t=[];d.gallery_images&&d.gallery_images.length>0?t=d.gallery_images.map((s,l)=>({id:`existing-${l}-${Date.now()}`,preview:s,url:s})):d.image_url&&(t=[{id:`legacy-${Date.now()}`,preview:d.image_url,url:d.image_url}]),N(t),w(d.menu_images||[])}else c({name:"",name_zh:"",name_pt:"",description:"",description_zh:"",description_pt:"",address:"",address_zh:"",address_pt:"",latitude:22.1987,longitude:113.5439,google_maps_url:"",location:"澳門",pet_policy:"patio_only",cuisine_type:[],cuisine_type_zh:[],cuisine_type_pt:[],image_url:"",gallery_images:[],contact_info:"",opening_hours:{},social_media:{},status:"pending"}),N([]),w([]);R([])},[d,g]);const Z=t=>{const s=Array.from(t.target.files||[]);if(s.length>0){const l=s.filter(a=>a.size>5242880?(b.error(`Image ${a.name} is too large (max 5MB)`),!1):!0);l.length>0&&l.forEach(a=>{const o=new FileReader;o.onloadend=()=>{N(i=>[...i,{id:`new-${Math.random().toString(36).substr(2,9)}`,preview:o.result,file:a}])},o.readAsDataURL(a)})}M.current&&(M.current.value="")},J=t=>{N(s=>s.filter(l=>l.id!==t))},K=(t,s)=>{if(s==="left"&&t===0||s==="right"&&t===_.length-1)return;const l=[..._],a=s==="left"?t-1:t+1,o=l[t];l[t]=l[a],l[a]=o,N(l)},ee=t=>{if(t===0)return;const s=[..._],l=s.splice(t,1)[0];s.unshift(l),N(s)},te=t=>{const s=Array.from(t.target.files||[]);if(s.length>0){const l=s.filter(a=>a.type.startsWith("image/")||a.type==="application/pdf"?a.size>5242880?(b.error(`File ${a.name} is too large (max 5MB)`),!1):!0:(b.error(`File ${a.name} is not a supported format (images or PDF)`),!1));if(l.length===0)return;R(a=>[...a,...l]),l.forEach(a=>{if(a.type==="application/pdf")w(o=>[...o,"PDF:"+a.name]);else{const o=new FileReader;o.onloadend=()=>{w(i=>[...i,o.result])},o.readAsDataURL(a)}})}},se=t=>{const s=(n.menu_images||[]).length;if(t<s){const l=[...n.menu_images||[]];l.splice(t,1),c(a=>({...a,menu_images:l})),w(a=>a.filter((o,i)=>i!==t))}else{const l=t-s;R(a=>a.filter((o,i)=>i!==l)),w(a=>a.filter((o,i)=>i!==t))}$.current&&($.current.value="")},re=()=>{const t=G.trim();if(!t)return;if(!t.startsWith("http://")&&!t.startsWith("https://")){b.error("Please enter a valid URL starting with http:// or https://");return}const s=[...n.menu_images||[],t];c(l=>({...l,menu_images:s})),w(l=>[...l,t]),V("")},ae=()=>{const t=W.trim();if(t){if(!t.startsWith("http://")&&!t.startsWith("https://")){b.error("Please enter a valid URL starting with http:// or https://");return}N(s=>[...s,{id:`url-${Date.now()}`,preview:t,url:t}]),H("")}},ne=async t=>{t.preventDefault(),I(!0),D(null);try{if(!n.cuisine_type||n.cuisine_type.length===0){b.error(r("submit:form.selectAtLeastOne")||"Please select at least one cuisine type"),I(!1);return}const s=[];for(const u of _)if(u.url)s.push(u.url);else if(u.file){const f=u.file.name.split(".").pop(),m=`${`${Math.random().toString(36).substring(2)}_${Date.now()}.${f}`}`,{error:L}=await C.storage.from("restaurants").upload(m,u.file);if(L)throw new Error(`Image upload failed: ${L.message}`);const{data:{publicUrl:T}}=C.storage.from("restaurants").getPublicUrl(m);s.push(T)}let l=s.length>0?s[0]:"";const a=[];if(A.length>0)for(const u of A){const f=u.name.split(".").pop(),m=`${`menu_${Math.random().toString(36).substring(2)}_${Date.now()}.${f}`}`,{error:L}=await C.storage.from("restaurants").upload(m,u);if(L)throw new Error(`Menu upload failed: ${L.message}`);const{data:{publicUrl:T}}=C.storage.from("restaurants").getPublicUrl(m);a.push(T)}const o=[...n.menu_images||[],...a],i={...n,gallery_images:s,menu_images:o,image_url:l};if(delete i.cuisine_type_other,n.cuisine_type&&Array.isArray(n.cuisine_type)){const u=f=>n.cuisine_type.map(j=>j==="Other"?n.cuisine_type_other||"Other":x.getFixedT(f)(`cuisineTypes.${j.toLowerCase()}`));if(i.cuisine_type_zh=u("zh"),i.cuisine_type_pt=u("pt"),i.cuisine_type?.includes("Other")&&n.cuisine_type_other){const f=n.cuisine_type_other;i.cuisine_type=i.cuisine_type.map(m=>m==="Other"?f:m);const j=n.cuisine_type_other;j&&(i.cuisine_type_zh=i.cuisine_type_zh.map(m=>m==="其他"||m==="Other"?j:m),i.cuisine_type_pt=i.cuisine_type_pt.map(m=>m==="Outros"||m==="Other"?j:m))}}if(d?.id){const{error:u}=await C.from("restaurants").update(i).eq("id",d.id);if(u)throw u}else{const{error:u}=await C.from("restaurants").insert(i);if(u)throw u}y(),p(),b.success(d?"Restaurant updated successfully":"Restaurant created successfully")}catch(s){console.error("Submission error:",s);const l=s instanceof Error?s.message:"An error occurred";D(l),b.error(l)}finally{I(!1)}};return g?e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/50 overflow-y-auto",style:{zIndex:100},children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-neutral-100 p-6 flex items-center justify-between z-10",children:[e.jsx("h2",{className:"text-xl font-bold text-neutral-900",children:d?"Edit Restaurant":"Add Restaurant"}),e.jsx("button",{onClick:p,className:"p-2 text-neutral-400 hover:bg-neutral-100 rounded-lg transition-colors",children:e.jsx(E,{size:20})})]}),e.jsxs("form",{onSubmit:ne,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-neutral-700",children:[e.jsx("span",{className:"text-red-500 text-xs mr-1",children:r("common:requiredField")}),r("admin:modal.labels.nameZh")]}),e.jsx("input",{type:"text",required:!0,value:n.name_zh||"",onChange:t=>c(s=>({...s,name_zh:t.target.value})),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:r("admin:modal.labels.nameEn")}),e.jsx("input",{type:"text",value:n.name||"",onChange:t=>c(s=>({...s,name:t.target.value})),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:r("admin:modal.labels.namePt")}),e.jsx("input",{type:"text",value:n.name_pt||"",onChange:t=>c(s=>({...s,name_pt:t.target.value})),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-neutral-700",children:[e.jsx("span",{className:"text-red-500 text-xs mr-1",children:r("common:requiredField")}),r("admin:modal.labels.cuisineType")]}),e.jsxs("div",{className:"grid grid-cols-2 xs:grid-cols-3 gap-2",children:[U.filter(t=>t.name!=="Other").map(t=>{const s=x.language==="zh"?t.name_zh||t.name:x.language==="pt"&&t.name_pt||t.name,a=(n.cuisine_type||[]).some(o=>o.toLowerCase()===t.name.toLowerCase());return e.jsx("button",{type:"button",onClick:()=>{const o=n.cuisine_type||[],u=o.find(f=>f.toLowerCase()===t.name.toLowerCase())?o.filter(f=>f.toLowerCase()!==t.name.toLowerCase()):[...o,t.name];c(f=>({...f,cuisine_type:u}))},className:`
                          px-2 py-1.5 rounded-lg text-xs font-medium transition-all border text-center truncate
                          ${a?"bg-primary-500 text-white border-primary-500 shadow-sm":"bg-white text-neutral-600 border-neutral-200 hover:border-primary-300 hover:bg-neutral-50"}
                        `,children:s},t.id)}),e.jsx("button",{type:"button",onClick:()=>{const t=n.cuisine_type||[],s=t.includes("Other")?t.filter(l=>l!=="Other"):[...t,"Other"];c(l=>({...l,cuisine_type:s}))},className:`
                      px-2 py-1.5 rounded-lg text-xs font-medium transition-all border text-center truncate
                      ${(n.cuisine_type||[]).includes("Other")?"bg-primary-500 text-white border-primary-500 shadow-sm":"bg-white text-neutral-600 border-neutral-200 hover:border-primary-300 hover:bg-neutral-50"}
                    `,children:r("common:other")||"Other"})]}),(n.cuisine_type||[]).includes("Other")&&e.jsx("input",{type:"text",required:!0,value:n.cuisine_type_other||"",onChange:t=>c(s=>({...s,cuisine_type_other:t.target.value})),placeholder:r("submit:form.otherCuisinePlaceholder")||"Please specify",className:"w-full mt-2 px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-neutral-700",children:[e.jsx("span",{className:"text-red-500 text-xs mr-1",children:r("common:requiredField")}),r("admin:modal.labels.petPolicy")]}),e.jsx("select",{required:!0,value:n.pet_policy||"patio_only",onChange:t=>c(s=>({...s,pet_policy:t.target.value})),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500",children:k.length>0?k.map(t=>e.jsx("option",{value:t.name,children:z(t.name,v)},t.name)):["indoors_allowed","patio_only","small_pets_only","all_pets_welcome","dogs_only","cats_only","medium_dogs_allowed"].map(t=>e.jsx("option",{value:t,children:z(t,v)},t))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:r("admin:modal.labels.status")}),e.jsxs("select",{value:n.status||"pending",onChange:t=>c(s=>({...s,status:t.target.value})),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"pending",children:r("admin:restaurants.status.pending")}),e.jsx("option",{value:"approved",children:r("admin:restaurants.status.approved")}),e.jsx("option",{value:"rejected",children:r("admin:restaurants.status.rejected")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:r("explore:filters.location")||"地區"}),e.jsxs("select",{value:n.location||"澳門",onChange:t=>c(s=>({...s,location:t.target.value})),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"澳門",children:"澳門 / Macau"}),e.jsx("option",{value:"氹仔",children:"氹仔 / Taipa"}),e.jsx("option",{value:"路環",children:"路環 / Coloane"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-neutral-700",children:[e.jsx("span",{className:"text-red-500 text-xs mr-1",children:r("common:requiredField")}),r("admin:modal.labels.descriptionZh")]}),e.jsx("textarea",{required:!0,rows:3,value:n.description_zh||"",onChange:t=>c(s=>({...s,description_zh:t.target.value})),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500",placeholder:r("admin:modal.placeholders.description")+" (中文)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:r("admin:modal.labels.descriptionEn")}),e.jsx("textarea",{rows:3,value:n.description||"",onChange:t=>c(s=>({...s,description:t.target.value})),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500",placeholder:r("admin:modal.placeholders.description")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:r("admin:modal.labels.descriptionPt")}),e.jsx("textarea",{rows:3,value:n.description_pt||"",onChange:t=>c(s=>({...s,description_pt:t.target.value})),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500",placeholder:r("admin:modal.placeholders.description")+" (葡文)"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-neutral-700",children:[e.jsx("span",{className:"text-red-500 text-xs mr-1",children:r("common:requiredField")}),r("admin:modal.labels.addressZh")]}),e.jsx("input",{type:"text",required:!0,value:n.address_zh||"",onChange:t=>c(s=>({...s,address_zh:t.target.value})),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500",placeholder:r("admin:modal.placeholders.address")+" (中文)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:r("admin:modal.labels.addressEn")}),e.jsx("input",{type:"text",value:n.address||"",onChange:t=>c(s=>({...s,address:t.target.value})),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500",placeholder:r("admin:modal.placeholders.address")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:r("admin:modal.labels.addressPt")}),e.jsx("input",{type:"text",value:n.address_pt||"",onChange:t=>c(s=>({...s,address_pt:t.target.value})),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500",placeholder:r("admin:modal.placeholders.address")+" (葡文)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:r("admin:modal.labels.contactInfo")}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-neutral-500 font-medium",children:"+853"})}),e.jsx("input",{type:"text",value:n.contact_info?.replace(/^\+853\s?/,"")||"",onChange:t=>{const s=t.target.value.replace(/^\+853\s?/,"");c(l=>({...l,contact_info:`+853 ${s}`}))},className:"w-full pl-16 pr-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500",placeholder:"6666 6666"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-neutral-700",children:r("restaurant:socialMedia.title")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-neutral-500",children:r("restaurant:socialMedia.facebook")}),e.jsx("input",{type:"url",value:n.social_media?.facebook||"",onChange:t=>c(s=>({...s,social_media:{...s.social_media||{},facebook:t.target.value||void 0}})),className:"w-full px-3 py-2 border border-neutral-200 rounded-lg text-sm focus:ring-2 focus:ring-primary-500",placeholder:"https://facebook.com/..."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-neutral-500",children:r("restaurant:socialMedia.instagram")}),e.jsx("input",{type:"url",value:n.social_media?.instagram||"",onChange:t=>c(s=>({...s,social_media:{...s.social_media||{},instagram:t.target.value||void 0}})),className:"w-full px-3 py-2 border border-neutral-200 rounded-lg text-sm focus:ring-2 focus:ring-primary-500",placeholder:"https://instagram.com/..."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-neutral-500",children:r("restaurant:socialMedia.website")}),e.jsx("input",{type:"url",value:n.social_media?.website||"",onChange:t=>c(s=>({...s,social_media:{...s.social_media||{},website:t.target.value||void 0}})),className:"w-full px-3 py-2 border border-neutral-200 rounded-lg text-sm focus:ring-2 focus:ring-primary-500",placeholder:"https://..."})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"text-sm font-medium text-neutral-700 flex items-center gap-2",children:[e.jsx(ie,{size:16,className:"text-primary-500"}),r("common:openingHours.title")]}),e.jsx("div",{className:"space-y-2",children:Q.map(t=>{const s=n.opening_hours?.[t],l=s!=null;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-24 text-sm text-neutral-600",children:r(`common:openingHours.days.${t}`)}),e.jsx("label",{className:"flex items-center gap-2",children:e.jsx("input",{type:"checkbox",checked:l,onChange:a=>{const o={...n.opening_hours||{}};a.target.checked?o[t]={open:"09:00",close:"22:00"}:o[t]=null,c(i=>({...i,opening_hours:o}))},className:"rounded border-neutral-300 text-primary-500 focus:ring-primary-500"})}),l?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"time",value:s?.open||"09:00",onChange:a=>{const o={...n.opening_hours||{}};o[t]={...o[t]||{},open:a.target.value},c(i=>({...i,opening_hours:o}))},className:"px-2 py-1 text-sm border border-neutral-200 rounded-lg focus:ring-2 focus:ring-primary-500"}),e.jsx("span",{className:"text-neutral-400",children:"-"}),e.jsx("input",{type:"time",value:s?.close||"22:00",onChange:a=>{const o={...n.opening_hours||{}};o[t]={...o[t]||{},close:a.target.value},c(i=>({...i,opening_hours:o}))},className:"px-2 py-1 text-sm border border-neutral-200 rounded-lg focus:ring-2 focus:ring-primary-500"}),e.jsxs("div",{className:"flex gap-1 ml-2",children:[e.jsx("button",{type:"button",onClick:()=>{const a=n.opening_hours?.[t];if(!a)return;const o=["monday","tuesday","wednesday","thursday","friday"],i={...n.opening_hours||{}};o.forEach(u=>{i[u]={...a}}),c(u=>({...u,opening_hours:i}))},className:"px-2 py-0.5 text-xs bg-neutral-100 hover:bg-neutral-200 text-neutral-600 rounded transition-colors",children:r("common:openingHours.applyToWeekdays")}),e.jsx("button",{type:"button",onClick:()=>{const a=n.opening_hours?.[t];if(!a)return;const o=["saturday","sunday"],i={...n.opening_hours||{}};o.forEach(u=>{i[u]={...a}}),c(u=>({...u,opening_hours:i}))},className:"px-2 py-0.5 text-xs bg-neutral-100 hover:bg-neutral-200 text-neutral-600 rounded transition-colors",children:r("common:openingHours.applyToWeekend")}),e.jsx("button",{type:"button",onClick:()=>{const a=n.opening_hours?.[t];if(!a)return;const o={...n.opening_hours||{}};Q.forEach(i=>{o[i]={...a}}),c(i=>({...i,opening_hours:o}))},className:"px-2 py-0.5 text-xs bg-primary-100 hover:bg-primary-200 text-primary-600 rounded transition-colors",children:r("common:openingHours.applyToAll")})]})]}):e.jsx("span",{className:"text-sm text-neutral-400",children:r("common:openingHours.closed")})]},t)})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium text-neutral-700 flex items-center gap-2",children:[e.jsx(ce,{size:16,className:"text-primary-500"}),r("admin:modal.labels.location")," *"]}),e.jsxs("span",{className:"text-xs text-neutral-500",children:[n.latitude?.toFixed(6),", ",n.longitude?.toFixed(6)]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(de,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400"}),e.jsx("input",{type:"text",value:F,onChange:t=>Y(t.target.value),placeholder:"Paste Google Maps URL here...",className:"w-full pl-10 pr-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("p",{className:"text-xs text-neutral-500",children:["1. Search the restaurant on ",e.jsx("a",{href:"https://maps.google.com",target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:underline",children:"Google Maps"})," ","2. Copy the URL from your browser 3. Paste it above"]})]}),!F&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-neutral-500",children:"Latitude"}),e.jsx("input",{type:"number",step:"any",value:n.latitude||"",onChange:t=>c(s=>({...s,latitude:parseFloat(t.target.value)})),className:"w-full px-3 py-2 border border-neutral-200 rounded-lg text-sm focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-neutral-500",children:"Longitude"}),e.jsx("input",{type:"number",step:"any",value:n.longitude||"",onChange:t=>c(s=>({...s,longitude:parseFloat(t.target.value)})),className:"w-full px-3 py-2 border border-neutral-200 rounded-lg text-sm focus:ring-2 focus:ring-primary-500"})]})]}),e.jsx("div",{className:"h-64 rounded-xl overflow-hidden border border-neutral-200",children:e.jsx("iframe",{title:"Location preview",width:"100%",height:"100%",style:{border:0},loading:"lazy",referrerPolicy:"no-referrer-when-downgrade",src:ge(F,n.latitude||22.1937,n.longitude||113.5399,n.name,x.language)})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-neutral-700",children:r("admin:modal.labels.imageUrl")}),e.jsxs("div",{className:"grid grid-cols-2 xs:grid-cols-3 md:grid-cols-4 gap-4",children:[_.map((t,s)=>e.jsxs("div",{className:"relative aspect-square group",children:[e.jsx("img",{src:t.preview,alt:`Preview ${s+1}`,className:`w-full h-full object-cover rounded-xl transition-all ${s===0?"ring-4 ring-primary-500":""}`}),s===0&&e.jsx("div",{className:"absolute top-2 left-2 px-2 py-1 bg-primary-500 text-white text-xs font-bold rounded-md shadow-sm",children:"Cover"}),e.jsxs("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity rounded-xl flex items-center justify-center gap-2",children:[s>0&&e.jsx("button",{type:"button",onClick:()=>K(s,"left"),className:"p-1.5 bg-white/20 hover:bg-white text-white hover:text-neutral-900 rounded-full backdrop-blur-sm transition-all",title:"Move Left",children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"m15 18-6-6 6-6"})})}),s<_.length-1&&e.jsx("button",{type:"button",onClick:()=>K(s,"right"),className:"p-1.5 bg-white/20 hover:bg-white text-white hover:text-neutral-900 rounded-full backdrop-blur-sm transition-all",title:"Move Right",children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"m9 18 6-6-6-6"})})}),s!==0&&e.jsx("button",{type:"button",onClick:()=>ee(s),className:"p-1.5 bg-primary-500 hover:bg-primary-600 text-white rounded-full transition-all",title:"Make Cover",children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),e.jsx("button",{type:"button",onClick:()=>J(t.id),className:"p-1.5 bg-red-500 hover:bg-red-600 text-white rounded-full transition-all",title:"Remove",children:e.jsx(E,{size:16})})]})]},t.id)),e.jsxs("div",{onClick:()=>M.current?.click(),className:`
                  border-2 border-dashed border-neutral-300
                  rounded-xl aspect-square
                  flex flex-col items-center justify-center
                  cursor-pointer
                  hover:border-primary-400 hover:bg-primary-50
                  transition-all
                `,children:[e.jsx("div",{className:"p-2 bg-neutral-100 rounded-full mb-2",children:e.jsx(S,{size:20,className:"text-neutral-400"})}),e.jsx("span",{className:"text-xs font-medium text-neutral-600 text-center px-2",children:_.length===0?r("admin:modal.buttons.uploadPhotos"):r("admin:modal.buttons.addMore")})]})]}),e.jsx("input",{ref:M,type:"file",accept:"image/*",multiple:!0,onChange:Z,className:"hidden"}),e.jsx("input",{ref:M,type:"file",accept:"image/*",multiple:!0,onChange:Z,className:"hidden"}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx("input",{type:"url",value:W,onChange:t=>H(t.target.value),placeholder:r("admin:modal.placeholders.imageUrlPlaceholder"),className:"flex-1 px-4 py-2 border-2 border-neutral-200 rounded-xl focus:border-primary-400 focus:ring-4 focus:ring-primary-100 focus:outline-none transition-all text-sm"}),e.jsx("button",{type:"button",onClick:ae,className:"px-4 py-2 bg-primary-500 text-white rounded-xl hover:bg-primary-600 transition-colors text-sm font-medium",children:r("admin:modal.buttons.addLink")})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-neutral-700",children:r("restaurant:menu")}),B.length>0?e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[B.map((t,s)=>e.jsxs("div",{className:"relative group",children:[t.startsWith("PDF:")||t.endsWith(".pdf")?e.jsxs("div",{className:"w-full h-32 rounded-xl border border-neutral-200 bg-neutral-50 flex flex-col items-center justify-center",children:[e.jsx(ue,{size:32,className:"text-red-500 mb-2"}),e.jsx("span",{className:"text-xs text-neutral-600 truncate max-w-full px-2",children:t.startsWith("PDF:")?t.slice(4):"PDF Menu"})]}):e.jsx("img",{src:t,alt:`Menu ${s}`,className:"w-full h-32 object-cover rounded-xl border border-neutral-200"}),e.jsx("button",{type:"button",onClick:()=>se(s),className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity shadow-lg",children:e.jsx(E,{size:14})})]},s)),e.jsxs("div",{onClick:()=>$.current?.click(),className:`
                    h-32 border-2 border-dashed border-neutral-300
                    rounded-xl flex flex-col items-center justify-center
                    cursor-pointer hover:border-primary-400 hover:bg-primary-50
                    transition-all
                  `,children:[e.jsx(S,{size:20,className:"text-neutral-400 mb-2"}),e.jsx("span",{className:"text-sm text-neutral-500",children:r("admin:modal.buttons.addMore")})]})]}):e.jsx("div",{onClick:()=>$.current?.click(),className:`
                  border-2 border-dashed border-neutral-300
                  rounded-xl p-6
                  text-center cursor-pointer
                  hover:border-primary-400 hover:bg-primary-50
                  transition-all
                `,children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(S,{size:24,className:"text-neutral-400"}),e.jsx("p",{className:"text-sm text-neutral-600",children:r("admin:modal.buttons.uploadMenu")})]})}),e.jsx("input",{ref:$,type:"file",accept:"image/*,.pdf,application/pdf",multiple:!0,onChange:te,className:"hidden"}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx("input",{type:"url",value:G,onChange:t=>V(t.target.value),placeholder:r("admin:modal.placeholders.menuUrlPlaceholder"),className:"flex-1 px-4 py-2 border-2 border-neutral-200 rounded-xl focus:border-primary-400 focus:ring-4 focus:ring-primary-100 focus:outline-none transition-all text-sm"}),e.jsx("button",{type:"button",onClick:re,className:"px-4 py-2 bg-primary-500 text-white rounded-xl hover:bg-primary-600 transition-colors text-sm font-medium",children:r("admin:modal.buttons.addLink")})]})]}),q&&e.jsx("div",{className:"p-4 bg-red-50 text-red-600 rounded-xl text-sm",children:q}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:p,className:"px-6 py-2 text-neutral-600 font-medium hover:bg-neutral-50 rounded-xl transition-colors",children:r("admin:modal.buttons.cancel")}),e.jsxs("button",{type:"submit",disabled:P,className:"px-6 py-2 bg-primary-500 hover:bg-primary-600 disabled:bg-primary-300 text-white font-medium rounded-xl transition-colors flex items-center gap-2",children:[P&&e.jsx(me,{size:18,className:"animate-spin"}),r(d?"admin:modal.buttons.save":"admin:modal.buttons.create")]})]})]})]})}):null}export{je as R,ge as g};
