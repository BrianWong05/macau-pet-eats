import{s as x,u as y,j as e,a as S}from"./index-Cv61YdKj.js";import{g as ce,L as z,r as i}from"./react-vendor-7d_4YsRm.js";import{R as de}from"./index-BTJCRS9H.js";import{K as me,R as ue,O as xe,Q as pe,V as he,x as X,y as G,A as fe,h as be,L as ge,i as je,W as ve,P as B,H as Q,S as W,e as Y,z as U,a as E,Y as Z,t as u,w as K,Z as Ne,X as ye,_ as we}from"./ui-vendor-BMPxCYOj.js";import{u as _e}from"./useFavorites-BRjbjFVi.js";import{R as ke}from"./index-BYJrRX1D.js";import{A as ze}from"./index-BGEkPg1K.js";import{L as Se}from"./index-BGr7p4pF.js";import"./supabase-K6a4hp2a.js";import"./index-CQXZkmI7.js";async function Ce(){const{data:{user:t}}=await x.auth.getUser();if(!t)return[];const{data:a,error:n}=await x.from("user_pets").select("*").eq("user_id",t.id).order("created_at",{ascending:!1});return n?(console.error("Error fetching user pets:",n),[]):a||[]}async function Pe(t){const{data:{user:a}}=await x.auth.getUser();if(!a)throw new Error("User not authenticated");const{data:n,error:r}=await x.from("user_pets").insert({user_id:a.id,name:t.name,type:t.type.toLowerCase(),size:t.size,breed:t.breed||null,image_url:t.image_url||null}).select().single();if(r)throw console.error("Error creating pet:",r),r;return n}async function Re(t,a){const{data:{user:n}}=await x.auth.getUser();if(!n)throw new Error("User not authenticated");const r={};a.name!==void 0&&(r.name=a.name),a.type!==void 0&&(r.type=a.type.toLowerCase()),a.size!==void 0&&(r.size=a.size),a.breed!==void 0&&(r.breed=a.breed),a.image_url!==void 0&&(r.image_url=a.image_url);const{data:c,error:m}=await x.from("user_pets").update(r).eq("id",t).eq("user_id",n.id).select().single();if(m)throw console.error("Error updating pet:",m),m;return c}async function Le(t){const{data:{user:a}}=await x.auth.getUser();if(!a)throw new Error("User not authenticated");const{error:n}=await x.from("user_pets").delete().eq("id",t).eq("user_id",a.id);if(n)throw console.error("Error deleting pet:",n),n;return!0}const Ue=["dog","cat","bird","rabbit","other"],Ee=[{value:"small",label:"Small (< 10kg)"},{value:"medium",label:"Medium (10-25kg)"},{value:"large",label:"Large (> 25kg)"}],V={dog:he,cat:pe,bird:xe,rabbit:ue,other:me},qe={small:"S",medium:"M",large:"L"},Fe={small:"bg-green-100 text-green-700",medium:"bg-amber-100 text-amber-700",large:"bg-red-100 text-red-700"};function Ae({pet:t,onEdit:a,onDelete:n}){const{t:r}=y(["common"]),c=V[t.type]||V.other;return e.jsxs("div",{className:"bg-white rounded-xl border border-neutral-200 overflow-hidden hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"aspect-square bg-gradient-to-br from-primary-50 to-primary-100 flex items-center justify-center relative",children:[t.image_url?e.jsx("img",{src:t.image_url,alt:t.name,className:"w-full h-full object-cover"}):e.jsx(c,{size:64,className:"text-primary-300"}),e.jsx("span",{className:`absolute top-2 right-2 px-2 py-0.5 rounded-full text-xs font-bold ${Fe[t.size]}`,children:qe[t.size]})]}),e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsx("h3",{className:"font-semibold text-lg text-neutral-900",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-neutral-500",children:[e.jsx(c,{size:16}),e.jsx("span",{className:"capitalize",children:t.type}),t.breed&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:t.breed})]})]}),(a||n)&&e.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t border-neutral-100",children:[a&&e.jsxs("button",{onClick:()=>a(t),className:"flex-1 inline-flex items-center justify-center gap-1 py-1.5 text-sm text-neutral-600 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",children:[e.jsx(X,{size:14}),r("common:edit")]}),n&&e.jsxs("button",{onClick:()=>n(t.id),className:"flex-1 inline-flex items-center justify-center gap-1 py-1.5 text-sm text-neutral-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[e.jsx(G,{size:14}),r("common:delete")]})]})]})]})}function De(){const{t}=y(["profile","restaurant","auth","common"]),{user:a,username:n,signOut:r}=S(),c=ce();return e.jsxs("header",{className:"bg-white border-b border-neutral-200 px-4 py-3 flex items-center justify-between shrink-0 z-20 sticky top-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>c(-1),className:"p-2 hover:bg-neutral-100 rounded-xl transition-colors","aria-label":t("restaurant:backToList"),children:e.jsx(fe,{size:20,className:"text-neutral-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-neutral-900",children:n||t("profile:title")}),a?.email&&e.jsx("p",{className:"text-sm text-neutral-500 hidden sm:block",children:a.email})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a&&e.jsxs(e.Fragment,{children:[e.jsx(z,{to:"/profile",className:"p-2 hover:bg-neutral-100 rounded-xl transition-colors text-primary-600",title:t("profile:title"),children:e.jsx(be,{size:20})}),e.jsx("button",{onClick:()=>r(),className:"p-2 hover:bg-neutral-100 rounded-xl transition-colors text-neutral-600 hover:text-red-600",title:t("auth:logout")||"Logout",children:e.jsx(ge,{size:20})})]}),e.jsxs(z,{to:"/submit",className:"inline-flex items-center gap-2 px-3 py-2 bg-white border border-neutral-200 rounded-xl text-sm font-medium text-neutral-700 hover:bg-neutral-50 transition-colors",children:[e.jsx(je,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:t("common:nav.submit")})]}),e.jsx(Se,{})]})]})}function Me(){const{t}=y(["profile","common"]),{username:a,updateUsername:n}=S(),[r,c]=i.useState(!1),[m,f]=i.useState(a||""),[h,b]=i.useState(!1),g=async()=>{if(!m.trim()){u.error(t("profile:usernameRequired"));return}b(!0);const{error:p}=await n(m.trim());b(!1),p?u.error(t("common:error")):(u.success(t("profile:usernameUpdated")),c(!1))};return r?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:m,onChange:p=>f(p.target.value),className:"text-xl font-bold text-neutral-900 border-b-2 border-primary-500 bg-transparent outline-none px-1",placeholder:t("profile:usernamePlaceholder"),autoFocus:!0}),e.jsx("button",{onClick:g,disabled:h,className:"p-1 text-green-600 hover:bg-green-50 rounded-full transition-colors",children:e.jsx(Ne,{size:18})}),e.jsx("button",{onClick:()=>{c(!1),f(a||"")},className:"p-1 text-red-600 hover:bg-red-50 rounded-full transition-colors",children:e.jsx(ye,{size:18})})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-xl font-bold text-neutral-900",children:a||t("profile:setUsername")}),e.jsx("button",{onClick:()=>c(!0),className:"p-1 text-neutral-400 hover:text-primary-600 hover:bg-primary-50 rounded-full transition-colors",title:t("profile:editUsername"),children:e.jsx(we,{size:16})})]})}function $e(){const{t}=y(["profile","common"]),{user:a,username:n,avatarUrl:r,updateAvatar:c}=S(),[m,f]=i.useState(!1),h=async g=>{const p=g.target.files?.[0];if(!p)return;if(!p.type.startsWith("image/")){u.error(t("common:uploadError"));return}if(p.size>2*1024*1024){u.error(t("profile:avatarTooLarge"));return}f(!0);const{error:j}=await c(p);f(!1),j?u.error(t("common:error")):u.success(t("profile:avatarUpdated"))},b=(n||a?.email?.charAt(0)||"?").charAt(0).toUpperCase();return e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs("label",{className:"relative w-20 h-20 cursor-pointer group",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:h,className:"hidden",disabled:m}),r?e.jsx("img",{src:r,alt:"Avatar",className:"w-20 h-20 rounded-full object-cover border-2 border-neutral-200 group-hover:border-primary-400 transition-colors"}):e.jsx("div",{className:"w-20 h-20 bg-primary-100 rounded-full flex items-center justify-center border-2 border-transparent group-hover:border-primary-400 transition-colors",children:e.jsx("span",{className:"text-2xl font-bold text-primary-600",children:b})}),m?e.jsx("div",{className:"absolute inset-0 bg-black/50 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"})}):e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/30 rounded-full flex items-center justify-center transition-colors",children:e.jsx(K,{className:"w-6 h-6 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]}),e.jsxs("label",{className:"text-sm text-primary-600 hover:text-primary-700 cursor-pointer font-medium flex items-center gap-1",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:h,className:"hidden",disabled:m}),e.jsx(K,{size:14}),t("profile:changePhoto")]})]})}function Xe(){const{t}=y(["profile","common","submit","feedback","auth"]),{user:a}=S(),[n,r]=i.useState("pets"),{favorites:c,isLoading:m}=_e(),[f,h]=i.useState([]),[b,g]=i.useState(!0),[p,j]=i.useState(!1),[v,N]=i.useState(null),[C,o]=i.useState(!1),[q,F]=i.useState([]),[J,P]=i.useState(!0),[A,D]=i.useState([]),[ee,R]=i.useState(!0),[M,$]=i.useState([]),[se,L]=i.useState(!0),[T,_]=i.useState([]),[te,w]=i.useState(!0),[H,ae]=i.useState(null),[I,O]=i.useState(!1);i.useEffect(()=>{(async()=>{if(!a){h([]),g(!1);return}g(!0);const l=await Ce();h(l),g(!1)})()},[a]),i.useEffect(()=>{(async()=>{if(!a){F([]),P(!1);return}P(!0);const{data:l,error:d}=await x.from("restaurants").select("*").eq("submitted_by",a.id).order("created_at",{ascending:!1});!d&&l&&F(l),P(!1)})()},[a]),i.useEffect(()=>{(async()=>{if(!a){D([]),R(!1);return}R(!0);const{data:l,error:d}=await x.from("app_feedback").select("*").eq("user_id",a.id).order("created_at",{ascending:!1});!d&&l&&D(l),R(!1)})()},[a]),i.useEffect(()=>{(async()=>{if(!a){$([]),L(!1);return}L(!0);const{data:l,error:d}=await x.from("restaurant_reports").select("*").eq("user_id",a.id).order("created_at",{ascending:!1});!d&&l&&$(l),L(!1)})()},[a]),i.useEffect(()=>{(async()=>{if(!a){_([]),w(!1);return}w(!0);const{data:l,error:d}=await x.from("reviews").select("id, restaurant_id, rating, comment, image_url, images, created_at, is_hidden, admin_comment, restaurants(name, name_zh)").eq("user_id",a.id).order("created_at",{ascending:!1});!d&&l&&_(l),w(!1)})()},[a]);const re=s=>{ae(s),O(!0)},le=async s=>{if(confirm(t("common:confirmDelete")))try{const{error:l}=await x.from("reviews").delete().eq("id",s);if(l)throw l;_(d=>d.filter(k=>k.id!==s)),u.success(t("common:deleteSuccess"))}catch{u.error(t("common:error"))}},ne=()=>{(async()=>{if(!a)return;w(!0);const{data:l,error:d}=await x.from("reviews").select("id, restaurant_id, rating, comment, image_url, images, created_at, is_hidden, admin_comment, restaurants(name, name_zh)").eq("user_id",a.id).order("created_at",{ascending:!1});!d&&l&&_(l),w(!1)})()},ie=async s=>{if(confirm(t("profile:pets.deleteConfirm")))try{await Le(s),h(l=>l.filter(d=>d.id!==s)),u.success(t("profile:pets.deleted"))}catch{u.error(t("common:error"))}},oe=s=>{N(s),j(!0)};return a?e.jsxs("div",{className:"min-h-screen bg-neutral-50",children:[e.jsx(De,{}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"h-24 sm:h-32 bg-gradient-to-br from-primary-400 via-primary-500 to-amber-400"}),e.jsx("div",{className:"mx-4 -mt-12 sm:-mt-16 bg-white rounded-2xl shadow-lg border border-neutral-100 p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col items-center text-center sm:flex-row sm:text-left sm:items-start gap-3 sm:gap-4",children:[e.jsx($e,{}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(Me,{}),e.jsx("p",{className:"text-neutral-500 text-sm truncate",children:a.email})]})]})})]}),e.jsx("div",{className:"px-4 mb-6",children:e.jsx("div",{className:"flex bg-neutral-100 rounded-2xl p-1 overflow-x-auto scrollbar-hide",children:[{key:"pets",icon:B,label:t("profile:tabs.pets")},{key:"favorites",icon:Q,label:t("profile:tabs.favorites")},{key:"contributions",icon:W,label:t("profile:tabs.contributions")},{key:"feedback",icon:Y,label:t("profile:tabs.feedback")},{key:"reports",icon:U,label:t("profile:tabs.reports")},{key:"reviews",icon:E,label:t("profile:tabs.reviews")}].map(s=>e.jsxs("button",{onClick:()=>r(s.key),className:`
                flex-1 min-w-fit flex flex-col items-center gap-1 px-3 py-2.5 sm:px-4 sm:py-3
                text-xs sm:text-sm font-medium rounded-xl transition-all
                ${n===s.key?"bg-white text-primary-600 shadow-sm":"text-neutral-500 hover:text-neutral-700"}
              `,children:[e.jsx(s.icon,{size:18}),e.jsx("span",{className:"truncate w-full text-center leading-tight",children:s.label})]},s.key))})}),e.jsxs("div",{className:"px-4",children:[n==="pets"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:()=>{N(null),j(!0)},className:"inline-flex items-center gap-2 px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white font-medium rounded-xl transition-colors",children:[e.jsx(Z,{size:18}),t("profile:pets.addPet")]}),b?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(s=>e.jsx("div",{className:"aspect-square bg-neutral-200 rounded-xl animate-pulse"},s))}):f.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-neutral-200",children:[e.jsx(B,{size:48,className:"mx-auto text-neutral-300 mb-4"}),e.jsx("p",{className:"text-neutral-600 font-medium",children:t("profile:pets.noPets")}),e.jsx("p",{className:"text-neutral-400 text-sm mt-1",children:t("profile:pets.noPetsHint")})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:f.map(s=>e.jsx(Ae,{pet:s,onEdit:oe,onDelete:ie},s.id))})]}),n==="favorites"&&e.jsx("div",{className:"space-y-6",children:m?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(s=>e.jsx("div",{className:"h-64 bg-neutral-200 rounded-xl animate-pulse"},s))}):c.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-neutral-200",children:[e.jsx(Q,{size:48,className:"mx-auto text-neutral-300 mb-4"}),e.jsx("p",{className:"text-neutral-600 font-medium",children:t("profile:favorites.noFavorites")}),e.jsx("p",{className:"text-neutral-400 text-sm mt-1",children:t("profile:favorites.noFavoritesHint")})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(s=>s.restaurant&&e.jsx(ke,{restaurant:s.restaurant},s.restaurant_id))})}),n==="contributions"&&e.jsx("div",{className:"space-y-6",children:J?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-24 bg-neutral-200 rounded-xl animate-pulse"},s))}):q.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-neutral-200",children:[e.jsx(W,{size:48,className:"mx-auto text-neutral-300 mb-4"}),e.jsx("p",{className:"text-neutral-600 font-medium",children:t("submit:noContributions")}),e.jsx("p",{className:"text-neutral-400 text-sm mt-1",children:t("submit:noContributionsHint")}),e.jsxs(z,{to:"/submit",className:"inline-flex items-center gap-2 mt-4 px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white font-medium rounded-xl transition-colors",children:[e.jsx(Z,{size:18}),t("submit:title")]})]}):e.jsx("div",{className:"space-y-4",children:q.map(s=>e.jsxs("div",{className:"bg-white rounded-xl border border-neutral-200 p-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[s.image_url&&e.jsx("img",{src:s.image_url,alt:s.name_zh||s.name,className:"w-16 h-16 rounded-lg object-cover"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-neutral-900 truncate",children:s.name_zh||s.name||t("common:unnamed")}),e.jsx("p",{className:"text-sm text-neutral-500 truncate",children:s.address_zh||s.address})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium whitespace-nowrap ${s.status==="approved"?"bg-green-100 text-green-700":s.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:s.status==="approved"?t("submit:status.approved"):s.status==="rejected"?t("submit:status.rejected"):t("submit:status.pending")})]}),s.admin_comment&&e.jsxs("div",{className:"mt-3 p-3 bg-neutral-50 rounded-lg border border-neutral-200",children:[e.jsx("p",{className:"text-xs font-medium text-neutral-500 mb-1",children:t("common:adminComment")}),e.jsx("p",{className:"text-sm text-neutral-700",children:s.admin_comment})]})]},s.id))})}),n==="feedback"&&e.jsx("div",{className:"space-y-6",children:ee?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-20 bg-neutral-200 rounded-xl animate-pulse"},s))}):A.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-neutral-200",children:[e.jsx(Y,{size:48,className:"mx-auto text-neutral-300 mb-4"}),e.jsx("p",{className:"text-neutral-600 font-medium",children:t("feedback:noFeedback")}),e.jsx("p",{className:"text-neutral-400 text-sm mt-1",children:t("feedback:noFeedbackHint")})]}):e.jsx("div",{className:"space-y-4",children:A.map(s=>e.jsxs("div",{className:"bg-white rounded-xl border border-neutral-200 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${s.type==="bug"?"bg-red-100 text-red-700":s.type==="feature"?"bg-amber-100 text-amber-700":"bg-blue-100 text-blue-700"}`,children:t(`feedback:types.${s.type}`)}),e.jsx("span",{className:"text-xs text-neutral-400",children:new Date(s.created_at).toLocaleDateString()})]}),e.jsx("p",{className:"text-neutral-700 text-sm line-clamp-2",children:s.message})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium whitespace-nowrap ${s.status==="resolved"?"bg-green-100 text-green-700":s.status==="reviewed"?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"}`,children:t(`feedback:status.${s.status}`)})]}),s.admin_comment&&e.jsxs("div",{className:"mt-3 p-3 bg-neutral-50 rounded-lg border border-neutral-200",children:[e.jsx("p",{className:"text-xs font-medium text-neutral-500 mb-1",children:t("common:adminComment")}),e.jsx("p",{className:"text-sm text-neutral-700",children:s.admin_comment})]})]},s.id))})}),n==="reports"&&e.jsx("div",{className:"space-y-6",children:se?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-20 bg-neutral-200 rounded-xl animate-pulse"},s))}):M.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-neutral-200",children:[e.jsx(U,{size:48,className:"mx-auto text-neutral-300 mb-4"}),e.jsx("p",{className:"text-neutral-600 font-medium",children:t("feedback:report.noReports")}),e.jsx("p",{className:"text-neutral-400 text-sm mt-1",children:t("feedback:report.noReportsHint")})]}):e.jsx("div",{className:"space-y-4",children:M.map(s=>e.jsxs("div",{className:"bg-white rounded-xl border border-neutral-200 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:s.field_name}),e.jsx("span",{className:"text-xs text-neutral-400",children:new Date(s.created_at).toLocaleDateString()})]}),e.jsx("p",{className:"text-neutral-600 text-sm truncate",children:s.suggested_value})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium whitespace-nowrap ${s.status==="approved"?"bg-green-100 text-green-700":s.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:t(`feedback:report.status.${s.status}`)})]}),s.admin_comment&&e.jsxs("div",{className:"mt-3 p-3 bg-neutral-50 rounded-lg border border-neutral-200",children:[e.jsx("p",{className:"text-xs font-medium text-neutral-500 mb-1",children:t("common:adminComment")}),e.jsx("p",{className:"text-sm text-neutral-700",children:s.admin_comment})]})]},s.id))})}),n==="reviews"&&e.jsx("div",{className:"space-y-6",children:te?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx("div",{className:"h-24 bg-neutral-200 rounded-xl animate-pulse"},s))}):T.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-neutral-200",children:[e.jsx(E,{size:48,className:"mx-auto text-neutral-300 mb-4"}),e.jsx("p",{className:"text-neutral-600 font-medium",children:t("profile:reviews.noReviews")}),e.jsx("p",{className:"text-neutral-400 text-sm mt-1",children:t("profile:reviews.noReviewsHint")})]}):e.jsx("div",{className:"space-y-4",children:T.map(s=>e.jsx(z,{to:`/restaurant/${s.restaurant_id}`,className:"block bg-white rounded-xl border border-neutral-200 p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"font-medium text-neutral-900 mb-1",children:[s.restaurants?.name_zh||s.restaurants?.name||t("common:unknown"),s.is_hidden&&e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-red-100 text-red-600 text-xs rounded-full",children:t("common:hidden")})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"flex",children:[1,2,3,4,5].map(l=>e.jsx(E,{size:14,className:l<=s.rating?"text-amber-400 fill-amber-400":"text-neutral-300"},l))}),e.jsx("span",{className:"text-xs text-neutral-400",children:new Date(s.created_at).toLocaleDateString()})]}),s.comment&&e.jsx("p",{className:"text-sm text-neutral-600 line-clamp-2",children:s.comment}),s.images&&s.images.length>0?e.jsx("div",{className:"mt-3 flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:s.images.map((l,d)=>e.jsx("img",{src:l,alt:"Review photo",className:"h-20 w-20 object-cover rounded-lg border border-neutral-200 flex-shrink-0"},d))}):s.image_url&&e.jsx("div",{className:"mt-3",children:e.jsx("img",{src:s.image_url,alt:"Review photo",className:"h-20 w-20 object-cover rounded-lg border border-neutral-200"})}),s.is_hidden&&s.admin_comment&&e.jsxs("div",{className:"mt-3 p-3 bg-red-50 rounded-lg border border-red-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(U,{size:14,className:"text-red-500"}),e.jsx("p",{className:"text-xs font-medium text-red-700",children:t("common:adminComment")})]}),e.jsx("p",{className:"text-sm text-red-800",children:s.admin_comment})]})]}),e.jsx("button",{onClick:l=>{l.preventDefault(),re(s)},className:"p-2 text-neutral-400 hover:text-primary-500 hover:bg-primary-50 rounded-full transition-colors",title:t("common:edit"),children:e.jsx(X,{size:18})}),e.jsx("button",{onClick:l=>{l.preventDefault(),le(s.id)},className:"p-2 text-neutral-400 hover:text-red-600 hover:bg-red-50 rounded-full transition-colors",title:t("common:delete"),children:e.jsx(G,{size:18})})]})},s.id))})}),I&&H&&e.jsx(de,{isOpen:I,onClose:()=>O(!1),onSuccess:ne,review:H}),p&&e.jsx(Te,{pet:v,onClose:()=>{j(!1),N(null)},onSave:async s=>{try{if(v){const l=await Re(v.id,s);h(d=>d.map(k=>k.id===v.id?l:k)),u.success(t("profile:pets.updated"))}else{const l=await Pe(s);h(d=>[l,...d]),u.success(t("profile:pets.added"))}j(!1),N(null)}catch{u.error(t("common:error"))}}})]})]}):e.jsxs("div",{className:"min-h-screen bg-neutral-50 flex items-center justify-center p-4",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-20 h-20 bg-primary-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(ve,{size:40,className:"text-primary-500"})}),e.jsx("h1",{className:"text-2xl font-bold text-neutral-900",children:t("profile:loginRequired")}),e.jsx("button",{onClick:()=>o(!0),className:"px-6 py-2 bg-primary-500 hover:bg-primary-600 text-white font-medium rounded-xl transition-colors",children:t("auth:loginButton")})]}),e.jsx(ze,{isOpen:C,onClose:()=>o(!1)})]})}function Te({pet:t,onClose:a,onSave:n}){const{t:r}=y(["profile","common"]),[c,m]=i.useState(t?.name||""),[f,h]=i.useState(t?.type||"dog"),[b,g]=i.useState(t?.size||"medium"),[p,j]=i.useState(t?.breed||""),[v,N]=i.useState(!1),C=async o=>{if(o.preventDefault(),!c.trim()){u.error(r("profile:pets.namePlaceholder"));return}N(!0),await n({name:c,type:f,size:b,breed:p||null}),N(!1)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6 space-y-6",children:[e.jsx("h2",{className:"text-xl font-bold text-neutral-900",children:r(t?"profile:pets.editPet":"profile:pets.addPet")}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700",children:r("profile:pets.name")}),e.jsx("input",{type:"text",value:c,onChange:o=>m(o.target.value),placeholder:r("profile:pets.namePlaceholder"),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700",children:r("profile:pets.type")}),e.jsx("select",{value:f,onChange:o=>h(o.target.value),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500",children:Ue.map(o=>e.jsx("option",{value:o,children:r(`profile:pets.types.${o}`)},o))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700",children:r("profile:pets.size")}),e.jsx("select",{value:b,onChange:o=>g(o.target.value),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500",children:Ee.map(o=>e.jsx("option",{value:o.value,children:r(`profile:pets.sizes.${o.value}`)},o.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700",children:r("profile:pets.breed")}),e.jsx("input",{type:"text",value:p,onChange:o=>j(o.target.value),placeholder:r("profile:pets.breedPlaceholder"),className:"w-full px-4 py-2 border border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-2 text-neutral-600 hover:bg-neutral-100 rounded-xl transition-colors",children:r("common:cancel")}),e.jsx("button",{type:"submit",disabled:v,className:"flex-1 px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white font-medium rounded-xl transition-colors disabled:opacity-50",children:r(v?"common:loading":"common:save")})]})]})]})})}export{Xe as Profile};
